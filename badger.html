<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Badger</title>
<link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&display=swap" rel="stylesheet">
<link id="badgeFontLink" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --bg: #f5f3f0;
    --surface: #ffffff;
    --border: #1a1a1a;
    --text: #1a1a1a;
    --text-muted: #6b6560;
    --accent: #1a1a1a;
    --mono: 'JetBrains Mono', 'SF Mono', 'Menlo', monospace;
  }

  body {
    font-family: var(--mono);
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    font-size: 12px;
  }

  .app-header {
    background: var(--surface);
    padding: 16px 28px;
    border-bottom: 2px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .app-header h1 {
    font-size: 56px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 3px;
  }

  .container {
    display: flex;
    height: calc(100vh - 52px);
  }

  .sidebar {
    width: 380px;
    min-width: 380px;
    background: var(--surface);
    border-right: 2px solid var(--border);
    display: flex;
    flex-direction: column;
    overflow-y: auto;
  }

  .sidebar-section {
    padding: 20px 24px;
    border-bottom: 1px solid #d4d0cc;
  }

  .sidebar-section h3 {
    font-size: 13px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: var(--text-muted);
    margin-bottom: 14px;
  }

  .sidebar-section label {
    display: block;
    font-size: 13px;
    color: var(--text-muted);
    margin-bottom: 4px;
    margin-top: 12px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .sidebar-section label:first-of-type {
    margin-top: 0;
  }

  textarea {
    width: 100%;
    height: 160px;
    background: var(--bg);
    border: 1px solid var(--border);
    color: var(--text);
    font-family: var(--mono);
    font-size: 11px;
    padding: 10px;
    resize: vertical;
  }

  textarea:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--border);
  }

  textarea::placeholder {
    color: #aaa5a0;
  }

  input[type="range"] {
    -webkit-appearance: none;
    appearance: none;
    height: 4px;
    background: var(--border);
    outline: none;
    cursor: pointer;
  }

  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 14px;
    height: 14px;
    background: var(--border);
    border: 2px solid var(--surface);
    box-shadow: 0 0 0 1px var(--border);
    cursor: pointer;
  }

  .format-hint {
    font-size: 13px;
    color: var(--text-muted);
    margin-top: 8px;
    line-height: 1.5;
  }

  input[type="number"], input[type="text"], input[type="url"], select {
    background: var(--bg);
    border: 1px solid var(--border);
    color: var(--text);
    font-family: var(--mono);
    font-size: 12px;
    padding: 6px 8px;
    width: 100%;
  }

  select {
    cursor: pointer;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%231a1a1a'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 8px center;
    padding-right: 24px;
  }

  input:focus, select:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--border);
  }

  .size-row {
    display: flex;
    gap: 12px;
  }

  .size-row > div { flex: 1; }

  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 8px 16px;
    border: 2px solid var(--border);
    background: var(--surface);
    font-family: var(--mono);
    font-size: 13px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    cursor: pointer;
    transition: all 0.1s;
    color: var(--text);
  }

  .btn:hover {
    background: var(--border);
    color: var(--surface);
  }

  .btn-primary {
    background: var(--border);
    color: var(--surface);
  }

  .btn-primary:hover {
    background: var(--surface);
    color: var(--border);
  }

  .btn-full {
    width: 100%;
    margin-top: 12px;
  }

  .upload-area {
    border: 1px dashed var(--border);
    padding: 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.1s;
    position: relative;
    background: var(--bg);
  }

  .upload-area:hover {
    background: var(--border);
    color: var(--surface);
  }

  #logoArea:hover {
    background: #c4d9c4;
    color: var(--text);
    border-color: #6a9a6a;
  }

  .upload-area.has-file {
    border-style: solid;
    background: var(--surface);
  }

  .upload-area .upload-text {
    font-size: 14px;
    display: block;
  }

  .upload-area .upload-filename {
    font-size: 14px;
    font-weight: 700;
    margin-top: 4px;
    display: block;
  }

  .upload-area .upload-hint {
    font-size: 13px;
    color: var(--text-muted);
    margin-top: 4px;
    display: block;
  }

  .upload-area input[type="file"] {
    position: absolute;
    inset: 0;
    opacity: 0;
    cursor: pointer;
  }

  .upload-area img {
    max-width: 60px;
    max-height: 60px;
    display: block;
    margin: 0 auto 6px auto;
  }

  .tabs {
    display: flex;
    gap: 0;
    margin-bottom: 14px;
    border: 1px solid var(--border);
  }

  .tab {
    flex: 1;
    padding: 8px;
    text-align: center;
    font-size: 13px;
    font-weight: 700;
    font-family: var(--mono);
    cursor: pointer;
    background: var(--bg);
    color: var(--text-muted);
    border: none;
    text-transform: uppercase;
    letter-spacing: 1px;
    transition: all 0.1s;
  }

  .tab:not(:last-child) { border-right: 1px solid var(--border); }

  .tab.active {
    background: var(--border);
    color: var(--surface);
  }

  .tab-content { display: none; }
  .tab-content.active { display: block; }

  .preview-area {
    flex: 1;
    overflow-y: auto;
    padding: 30px;
    background: var(--bg);
  }

  .preview-area .page {
    width: 210mm;
    height: 297mm;
    margin: 0 auto 24px auto;
    background: white;
    display: flex;
    flex-wrap: wrap;
    align-content: flex-start;
    padding: 10mm;
    gap: 4mm;
    box-shadow: 4px 4px 0 var(--border);
    border: 1px solid var(--border);
  }

  .badge {
    width: 92mm;
    height: 59mm;
    border: 0.3mm solid #ccc;
    overflow: hidden;
    position: relative;
    padding: 5mm;
    background: white;
    color: #000;
  }

  .badge-top {
    position: absolute;
    top: 5mm;
    left: 5mm;
    right: 5mm;
    z-index: 0;
    pointer-events: none;
  }

  .badge-top .logo-img {
    height: auto;
    display: block;
    object-fit: contain;
  }

  .badge-bottom {
    position: absolute;
    bottom: 5mm;
    left: 5mm;
    right: 5mm;
    z-index: 1;
  }

  /* Layout A: Klassisk (default) */
  .badge--layout-a .badge-bottom {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    gap: 4mm;
  }

  .badge--layout-a .badge-bottom .qr {
    width: 18mm;
    height: 18mm;
    flex-shrink: 0;
  }

  .badge--layout-a .badge-bottom .qr img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: left bottom;
  }

  .badge--layout-a .badge-bottom .info {
    text-align: right;
    flex: 1;
  }

  /* Layout C: Speilvendt */
  .badge--layout-c .badge-bottom {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    gap: 4mm;
    flex-direction: row-reverse;
  }

  .badge--layout-c .badge-bottom .qr {
    width: 18mm;
    height: 18mm;
    flex-shrink: 0;
  }

  .badge--layout-c .badge-bottom .qr img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: right bottom;
  }

  .badge--layout-c .badge-bottom .info {
    text-align: left;
    flex: 1;
  }

  /* Badge text styles (default) */
  .badge .info .name {
    font-family: 'Lato', sans-serif;
    font-size: 12pt;
    font-weight: 700;
    color: #000;
    line-height: 1.2;
  }

  .badge .info .commission {
    font-family: 'Lato', sans-serif;
    font-size: 9pt;
    font-weight: 400;
    color: #000;
    line-height: 1.2;
    margin-top: 0.5mm;
  }

  .badge .info .country {
    font-family: 'Lato', sans-serif;
    font-size: 8pt;
    font-weight: 400;
    color: #000;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-top: 0.5mm;
  }

  .badge-count {
    font-size: 11px;
    color: var(--text-muted);
    margin-bottom: 16px;
    text-align: center;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .entries-list {
    border: 1px solid var(--border);
    margin-top: 10px;
    max-height: 300px;
    overflow-y: auto;
  }

  .entry-item {
    padding: 8px 10px;
    border-bottom: 1px solid #d4d0cc;
    font-size: 11px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .entry-item:last-child { border-bottom: none; }

  .entry-item .entry-name { font-weight: 700; font-size: 11px; }
  .entry-item .entry-commission { color: var(--text-muted); font-size: 13px; }
  .entry-item .entry-country { color: var(--text-muted); font-size: 9px; text-transform: uppercase; letter-spacing: 1px; }

  .entry-item .remove-btn {
    background: none;
    border: 1px solid var(--border);
    color: var(--text);
    cursor: pointer;
    font-family: var(--mono);
    font-size: 13px;
    padding: 2px 6px;
    line-height: 1;
    transition: all 0.1s;
  }

  .entry-item .remove-btn:hover {
    background: var(--border);
    color: var(--surface);
  }

  .empty-state {
    text-align: center;
    padding: 80px 30px;
    color: var(--text-muted);
  }

  .empty-state p {
    font-size: 12px;
    line-height: 1.8;
    max-width: 300px;
    margin: 0 auto;
  }

  /* Layout selector */
  .layout-row {
    display: flex;
    gap: 6px;
  }

  .layout-btn {
    flex: 1;
    padding: 8px 4px;
    border: 2px solid var(--border);
    background: var(--bg);
    font-family: var(--mono);
    font-size: 9px;
    font-weight: 700;
    cursor: pointer;
    text-align: center;
    transition: all 0.1s;
    color: var(--text);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .layout-btn:hover {
    background: #e8e5e2;
  }

  .layout-btn.active {
    background: var(--border);
    color: var(--surface);
  }

  .layout-btn .layout-icon {
    display: block;
    font-size: 16px;
    margin-bottom: 4px;
    line-height: 1;
  }

  /* QR style selector */
  .qr-style-row {
    display: flex;
    gap: 6px;
    margin-top: 10px;
  }

  .qr-style-btn {
    flex: 1;
    padding: 7px 4px;
    border: 1px solid var(--border);
    background: var(--bg);
    font-family: var(--mono);
    font-size: 9px;
    font-weight: 700;
    cursor: pointer;
    text-align: center;
    transition: all 0.1s;
    color: var(--text);
  }

  .qr-style-btn:hover { background: #e8e5e2; }

  .qr-style-btn.active {
    background: var(--border);
    color: var(--surface);
  }

  /* QR color inputs */
  .qr-color-row {
    display: flex;
    gap: 12px;
    margin-top: 10px;
  }

  .qr-color-row > div {
    flex: 1;
  }

  .qr-color-row input[type="color"] {
    width: 100%;
    height: 30px;
    border: 1px solid var(--border);
    background: var(--bg);
    cursor: pointer;
    padding: 2px;
  }

  .qr-color-row input[type="color"]::-webkit-color-swatch-wrapper { padding: 0; }
  .qr-color-row input[type="color"]::-webkit-color-swatch { border: none; }

  /* Font size row */
  .font-size-row {
    display: flex;
    gap: 8px;
  }

  .font-size-row > div { flex: 1; }

  .excel-columns {
    margin-top: 10px;
    padding: 10px;
    background: var(--bg);
    border: 1px solid #d4d0cc;
    font-size: 13px;
    line-height: 1.7;
    color: var(--text-muted);
  }

  .excel-columns strong {
    color: var(--text);
    font-weight: 700;
  }

  @media print {
    * { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    html, body {
      background: white;
      margin: 0;
      padding: 0;
      width: 210mm;
      height: auto;
      overflow: visible;
    }
    .app-header, .sidebar, .badge-count, .empty-state { display: none !important; }
    .container {
      display: block;
      width: auto;
      height: auto;
      overflow: visible;
    }
    .preview-area {
      padding: 0;
      margin: 0;
      background: white;
      overflow: visible;
      width: auto;
      height: auto;
    }
    .preview-area .page {
      width: 210mm;
      height: 297mm;
      box-shadow: none;
      border: none;
      margin: 0;
      padding: 10mm;
      overflow: visible;
      page-break-after: always;
      break-after: page;
      page-break-inside: avoid;
      break-inside: avoid;
    }
    .preview-area .page:last-child {
      page-break-after: auto;
      break-after: auto;
    }
    .badge {
      border: 0.2mm solid #ccc;
      page-break-inside: avoid;
      break-inside: avoid;
    }
  }

  @page {
    size: A4;
    margin: 0;
  }
</style>
</head>
<body>

<div class="app-header">
  <div style="display:flex;align-items:center;gap:10px">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="96" height="96" fill="none" stroke="#1a1a1a" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M32 18 C28 10, 22 12, 26 22"/><path d="M68 18 C72 10, 78 12, 74 22"/><path d="M26 22 C24 30, 22 38, 30 50 L44 68"/><path d="M74 22 C76 30, 78 38, 70 50 L56 68"/><path d="M38 20 C42 32, 44 46, 46 64"/><path d="M62 20 C58 32, 56 46, 54 64"/><path d="M46 64 C46 68, 48 72, 50 72 C52 72, 54 68, 54 64"/><path d="M44 68 C46 74, 48 76, 50 76 C52 76, 54 74, 56 68"/><ellipse cx="50" cy="68" rx="4" ry="3" fill="#1a1a1a" stroke="none"/><circle cx="39" cy="42" r="3" fill="#1a1a1a" stroke="none"/><circle cx="61" cy="42" r="3" fill="#1a1a1a" stroke="none"/></svg>
    <div>
      <h1 style="margin:0;line-height:1">Badger</h1>
      <div style="font-size:10px;font-weight:400;text-transform:uppercase;color:var(--text-muted);letter-spacing:1px;margin-top:-1px;padding-left:3px">Konferanselapper minus hodepine</div>
    </div>
  </div>
  <div style="display:flex;gap:8px">
    <button class="btn" id="resetBtn" onclick="resetAll()">Nullstill</button>
    <button class="btn btn-primary" onclick="printBadges()">Eksporter</button>
  </div>
</div>

<div class="container">
  <div class="sidebar">

    <!-- 0. Skiltformat -->
    <div class="sidebar-section">
      <h3>Skiltformat</h3>
      <div class="size-row">
        <div>
          <label>Bredde mm</label>
          <input type="number" id="badgeWidth" value="92" onchange="renderBadges()">
        </div>
        <div>
          <label>Hoyde mm</label>
          <input type="number" id="badgeHeight" value="59" onchange="renderBadges()">
        </div>
      </div>
    </div>

    <!-- 1. Logo -->
    <div class="sidebar-section">
      <h3>Logo</h3>
      <div class="upload-area" id="logoArea" style="background:#f0f7f0;border-color:#8cb88c">
        <span class="upload-text">Last opp logo</span>
        <span class="upload-hint">.png / .jpg</span>
        <input type="file" accept="image/*" onchange="loadLogo(event)">
      </div>
      <div class="format-hint">
        Min. 300px bredde for god utskriftskvalitet.
      </div>
      <div id="logoControls" style="display:none">
        <label>Bredde</label>
        <div style="display:flex;align-items:center;gap:10px">
          <input type="range" id="logoWidth" min="20" max="100" value="100" oninput="updateLogoWidth()" style="flex:1">
          <span id="logoWidthVal" style="font-size:11px;min-width:32px">100%</span>
        </div>
        <label>Justering</label>
        <div class="layout-row">
          <button class="layout-btn" data-align="left" onclick="setLogoAlign('left', this)">Venstre</button>
          <button class="layout-btn active" data-align="center" onclick="setLogoAlign('center', this)">Sentrert</button>
          <button class="layout-btn" data-align="right" onclick="setLogoAlign('right', this)">H&oslash;yre</button>
        </div>
      </div>
    </div>

    <!-- 2. QR-kode med Generer/Last opp tabs -->
    <div class="sidebar-section">
      <h3>QR-kode</h3>
        <label style="margin-top:0">URL</label>
        <input type="url" id="qrUrl" placeholder="https://example.com" oninput="generateQR()">
        <div style="margin-top:10px">
          <label>Farge</label>
          <input type="color" id="qrColor" value="#000000" onchange="generateQR()" style="width:30px;height:30px;border:1px solid var(--border);background:var(--bg);cursor:pointer;padding:2px">
        </div>
        <div class="qr-style-row">
          <button class="qr-style-btn active" data-style="square" onclick="setQrStyle('square', this)">&#9632; Kantet</button>
          <button class="qr-style-btn" data-style="dots" onclick="setQrStyle('dots', this)">&#9679; Prikker</button>
          <button class="qr-style-btn" data-style="rounded" onclick="setQrStyle('rounded', this)">&#9673; Avrundet</button>
        </div>
        <div id="qrPreview" style="margin-top:12px;text-align:center"></div>
    </div>

    <!-- 3. Deltakere -->
    <div class="sidebar-section">
      <h3>Deltakere</h3>

      <div class="tabs">
        <button class="tab active" onclick="switchTab('excel', this)">Regneark</button>
        <button class="tab" onclick="switchTab('text', this)">Tekst</button>
      </div>

      <div class="tab-content active" id="tab-excel">
        <div class="upload-area" id="excelArea">
          <span class="upload-text">Last opp regneark</span>
          <span class="upload-hint">.xlsx / .csv</span>
          <input type="file" accept=".xlsx,.xls,.csv" onchange="loadExcel(event)">
        </div>
        <div class="excel-columns">
          Tre kolonner: <strong>Navn</strong>, <strong>Stilling</strong>, <strong>Firma</strong>
        </div>
      </div>

      <div class="tab-content" id="tab-text">
        <label>Navn, stilling og firma &mdash; tre linjer per person</label>
        <textarea id="inputList" placeholder="Ola Nordmann&#10;Daglig leder&#10;Norsk Industri AS&#10;&#10;Kari Hansen&#10;Prosjektleder&#10;Bergen Consulting&#10;&#10;Erik Johansen&#10;Markedssjef&#10;Stavanger Tech" oninput="parseTextInput()"></textarea>
      </div>
    </div>

    <!-- 4. Layout -->
    <div class="sidebar-section design-section" style="display:none">
      <h3>Layout</h3>
      <div class="layout-row">
        <button class="layout-btn active" data-layout="a" onclick="setLayout('a', this)">
          <span class="layout-icon">&#9638;</span>H&oslash;yrestilt
        </button>
        <button class="layout-btn" data-layout="c" onclick="setLayout('c', this)">
          <span class="layout-icon">&#9639;</span>Venstrestilt
        </button>
      </div>
      <div class="format-hint" id="layoutDesc">H&oslash;yrestilt &mdash; QR venstre, info h&oslash;yre</div>
    </div>

    <!-- 5. Skrift -->
    <div class="sidebar-section design-section" style="display:none">
      <h3>Skrift</h3>
      <label style="margin-top:0">Font</label>
      <select id="fontSelect" onchange="changeFont()">
        <option value="Lato" selected>Lato</option>
        <option value="Inter">Inter</option>
        <option value="Roboto">Roboto</option>
        <option value="Open Sans">Open Sans</option>
        <option value="Playfair Display">Playfair Display</option>
        <option value="Merriweather">Merriweather</option>
        <option value="Oswald">Oswald</option>
        <option value="Montserrat">Montserrat</option>
      </select>
      <div class="font-size-row" style="margin-top:12px">
        <div>
          <label>Navn pt</label>
          <input type="number" id="fontSize_name" value="18" min="6" max="30" onchange="renderBadges()">
        </div>
        <div>
          <label>Stilling pt</label>
          <input type="number" id="fontSize_commission" value="12" min="5" max="24" onchange="renderBadges()">
        </div>
        <div>
          <label>Firma pt</label>
          <input type="number" id="fontSize_company" value="9" min="5" max="20" onchange="renderBadges()">
        </div>
      </div>
    </div>


    <!-- 7. Liste -->
    <div class="sidebar-section">
      <div style="display:flex;justify-content:space-between;align-items:baseline;margin-bottom:10px">
        <h3 id="entriesHeader" style="margin-bottom:0">Liste (0)</h3>
        <button class="btn" onclick="clearAll()" style="padding:4px 8px;font-size:9px">Nullstill</button>
      </div>
      <div class="entries-list" id="entriesList"></div>
    </div>

  </div>

  <div class="preview-area" id="previewArea">
    <div class="empty-state">
      <p>Versjon 1.0 — av Hallvar Bugge Johnsen / hei@hallvar.no</p>
    </div>
  </div>
</div>

<script>
const a0_0x1f96de=a0_0x52c7;(function(_0x401bee,_0x266fc){const _0x8649c0=a0_0x52c7,_0x2eeedf=_0x401bee();while(!![]){try{const _0x4837da=-parseInt(_0x8649c0(0xb1))/0x1+parseInt(_0x8649c0(0x155))/0x2*(-parseInt(_0x8649c0(0x14d))/0x3)+-parseInt(_0x8649c0(0x117))/0x4+-parseInt(_0x8649c0(0x149))/0x5+-parseInt(_0x8649c0(0x133))/0x6*(parseInt(_0x8649c0(0xed))/0x7)+-parseInt(_0x8649c0(0xf5))/0x8+parseInt(_0x8649c0(0x8e))/0x9*(parseInt(_0x8649c0(0x8a))/0xa);if(_0x4837da===_0x266fc)break;else _0x2eeedf['push'](_0x2eeedf['shift']());}catch(_0x20ce8e){_0x2eeedf['push'](_0x2eeedf['shift']());}}}(a0_0x174c,0xaefc0));let entries=[],qrDataUrl=null,logoDataUrl=null,currentLayout='a',currentFont=a0_0x1f96de(0xb2),qrDotStyle=a0_0x1f96de(0xa5),qrCodeInstance=null,logoWidthPct=0x64,logoAlign=a0_0x1f96de(0x15f);const layoutDescriptions={'a':a0_0x1f96de(0x99),'c':a0_0x1f96de(0x10c)};function loadLogo(_0x39286a){const _0x21be7f=a0_0x1f96de,_0x4c011b={'UJpot':'logoArea','gAvEx':_0x21be7f(0xc7),'wTgbD':function(_0x4ca200,_0x6afe2d){return _0x4ca200(_0x6afe2d);}},_0x4c254f=_0x39286a[_0x21be7f(0x13a)][_0x21be7f(0x13b)][0x0];if(!_0x4c254f)return;const _0x5de5f6=new FileReader();_0x5de5f6[_0x21be7f(0xa2)]=function(_0x76f864){const _0x2e2452=_0x21be7f;logoDataUrl=_0x76f864[_0x2e2452(0x13a)][_0x2e2452(0x157)];const _0xe5684a=document[_0x2e2452(0xe6)](_0x4c011b['UJpot']);_0xe5684a[_0x2e2452(0xf2)][_0x2e2452(0xb0)](_0x4c011b[_0x2e2452(0xc8)]),_0xe5684a[_0x2e2452(0x8c)]=_0x2e2452(0xdd)+logoDataUrl+_0x2e2452(0x112)+_0x4c011b[_0x2e2452(0xc4)](esc,_0x4c254f[_0x2e2452(0x9f)])+_0x2e2452(0xee),document[_0x2e2452(0xe6)](_0x2e2452(0x104))[_0x2e2452(0x15b)]['display']='',renderBadges();},_0x5de5f6['readAsDataURL'](_0x4c254f);}const countryMap={'faroe':a0_0x1f96de(0x15c),'finland':a0_0x1f96de(0xf0),'finnish':a0_0x1f96de(0xf0),'tampere':'Finland','lapland':a0_0x1f96de(0xf0),'greenland':'Greenland','film\x20gl':a0_0x1f96de(0xe1),'iceland':a0_0x1f96de(0xda),'norway':'Norway','norwegian':'Norway','oslo':a0_0x1f96de(0xb3),'arktisk':a0_0x1f96de(0xb3),'midgard':a0_0x1f96de(0xb3),'western\x20norway':a0_0x1f96de(0xb3),'eastern\x20norway':a0_0x1f96de(0xb3),'sweden':a0_0x1f96de(0xa9),'swedish':'Sweden','stockholm':a0_0x1f96de(0xa9),'gotland':a0_0x1f96de(0xa9),'åland':a0_0x1f96de(0xb4),'film.ax':a0_0x1f96de(0xb4),'denmark':a0_0x1f96de(0xa3),'danish':a0_0x1f96de(0xa3),'vision\x20denmark':a0_0x1f96de(0xa3),'north\x20finland':'Finland','west\x20finland':a0_0x1f96de(0xf0),'east\x20finland':'Finland','southern\x20sweden':'Sweden'};function detectCountry(_0x2dcf18){const _0x3a881e=a0_0x1f96de,_0x13b854=_0x2dcf18['toLowerCase']();for(const [_0x174818,_0x3aacd6]of Object[_0x3a881e(0x169)](countryMap)){if(_0x13b854[_0x3a881e(0xd9)](_0x174818))return _0x3aacd6;}return'';}function switchTab(_0x556a0b,_0x54a86d){const _0x16e13c=a0_0x1f96de,_0x525640={'hdYTo':_0x16e13c(0x122),'EUZEC':_0x16e13c(0x9a),'HOdMu':_0x16e13c(0xab),'ierIn':function(_0x5330d7,_0x178600){return _0x5330d7+_0x178600;},'nLywI':'#tab-'},_0xa70752=_0x54a86d[_0x16e13c(0xcd)](_0x525640[_0x16e13c(0x8b)]);_0xa70752[_0x16e13c(0x120)](_0x16e13c(0xd2))[_0x16e13c(0x108)](_0x9f3c3a=>_0x9f3c3a[_0x16e13c(0xf2)][_0x16e13c(0x92)](_0x16e13c(0xab))),_0xa70752['querySelectorAll'](_0x525640[_0x16e13c(0xad)])[_0x16e13c(0x108)](_0x3b8194=>_0x3b8194[_0x16e13c(0xf2)][_0x16e13c(0x92)](_0x16e13c(0xab))),_0x54a86d['classList'][_0x16e13c(0xb0)](_0x525640[_0x16e13c(0xbd)]),_0xa70752[_0x16e13c(0x124)](_0x525640[_0x16e13c(0x129)](_0x525640[_0x16e13c(0x116)],_0x556a0b))[_0x16e13c(0xf2)][_0x16e13c(0xb0)](_0x525640[_0x16e13c(0xbd)]);}function switchQrTab(_0x579d4d,_0x503d1c){const _0x1bd52e=a0_0x1f96de,_0x5bcfe6={'DHoIA':_0x1bd52e(0x122),'wSToR':_0x1bd52e(0xd2),'Gqyuk':'.tab-content','GNlKm':_0x1bd52e(0xab),'sBWqw':_0x1bd52e(0x85)},_0x2019f9=_0x503d1c[_0x1bd52e(0xcd)](_0x5bcfe6[_0x1bd52e(0x147)]);_0x2019f9[_0x1bd52e(0x120)](_0x5bcfe6[_0x1bd52e(0xe4)])[_0x1bd52e(0x108)](_0x4d6cd0=>_0x4d6cd0[_0x1bd52e(0xf2)][_0x1bd52e(0x92)](_0x1bd52e(0xab))),_0x2019f9[_0x1bd52e(0x120)](_0x5bcfe6[_0x1bd52e(0xe9)])[_0x1bd52e(0x108)](_0x63943a=>_0x63943a[_0x1bd52e(0xf2)][_0x1bd52e(0x92)](_0x1bd52e(0xab))),_0x503d1c[_0x1bd52e(0xf2)][_0x1bd52e(0xb0)](_0x5bcfe6[_0x1bd52e(0x16f)]),_0x2019f9[_0x1bd52e(0x124)](_0x5bcfe6['sBWqw']+_0x579d4d)[_0x1bd52e(0xf2)][_0x1bd52e(0xb0)](_0x5bcfe6[_0x1bd52e(0x16f)]);}function loadQR(_0x4873bb){const _0x1b4f07=a0_0x1f96de,_0x1d1cb2={'gFFMj':_0x1b4f07(0x11a),'vhyBS':function(_0x5a2c8b,_0x163bf4){return _0x5a2c8b(_0x163bf4);}},_0x1a428b=_0x4873bb[_0x1b4f07(0x13a)]['files'][0x0];if(!_0x1a428b)return;const _0x4b44f4=new FileReader();_0x4b44f4[_0x1b4f07(0xa2)]=function(_0x6b0e1){const _0x51e45e=_0x1b4f07;qrDataUrl=_0x6b0e1[_0x51e45e(0x13a)]['result'];const _0x29553f=document[_0x51e45e(0xe6)](_0x1d1cb2[_0x51e45e(0x164)]);_0x29553f[_0x51e45e(0xf2)][_0x51e45e(0xb0)]('has-file'),_0x29553f[_0x51e45e(0x8c)]=_0x51e45e(0xdd)+qrDataUrl+_0x51e45e(0x86)+_0x1d1cb2[_0x51e45e(0x154)](esc,_0x1a428b[_0x51e45e(0x9f)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20accept=\x22image/*\x22\x20onchange=\x22loadQR(event)\x22>',renderBadges();},_0x4b44f4[_0x1b4f07(0x140)](_0x1a428b);}function setQrStyle(_0x502513,_0x40b359){const _0x14fc9c=a0_0x1f96de,_0x41fe06={'ZgoVC':_0x14fc9c(0xe7),'OpSrZ':function(_0x45545c){return _0x45545c();}};qrDotStyle=_0x502513,document['querySelectorAll'](_0x41fe06[_0x14fc9c(0x151)])['forEach'](_0x1da722=>_0x1da722[_0x14fc9c(0xf2)][_0x14fc9c(0x92)](_0x14fc9c(0xab))),_0x40b359[_0x14fc9c(0xf2)]['add']('active'),_0x41fe06['OpSrZ'](generateQR);}function generateQR(){const _0x14764d=a0_0x1f96de,_0x8bcf9c={'zIvfU':_0x14764d(0xb7),'GEVpc':_0x14764d(0x11f),'rTGZp':'img','bKsdW':function(_0x45dd94){return _0x45dd94();},'OCvLV':_0x14764d(0x97),'rLAbw':function(_0x3ca00c){return _0x3ca00c();},'LhcpS':_0x14764d(0xa5),'lyilv':_0x14764d(0x134),'taBbw':_0x14764d(0xbe),'uDwto':function(_0x497ac3,_0x486d8e,_0x516757){return _0x497ac3(_0x486d8e,_0x516757);}},_0x21ad92=document[_0x14764d(0xe6)](_0x14764d(0x136))[_0x14764d(0xf7)]['trim'](),_0x1a8562=document[_0x14764d(0xe6)](_0x8bcf9c[_0x14764d(0xb5)]);if(!_0x21ad92){_0x1a8562[_0x14764d(0x8c)]='',qrDataUrl=null,_0x8bcf9c['rLAbw'](renderBadges);return;}const _0x30cb97=document[_0x14764d(0xe6)](_0x14764d(0x121))[_0x14764d(0xf7)],_0x11b6c3={'square':_0x8bcf9c[_0x14764d(0xc6)],'dots':'dots','rounded':_0x8bcf9c[_0x14764d(0x109)]},_0x3cb528={'width':0x12c,'height':0x12c,'data':_0x21ad92,'dotsOptions':{'color':_0x30cb97,'type':_0x11b6c3[qrDotStyle]||_0x8bcf9c['LhcpS']},'backgroundOptions':{'color':_0x8bcf9c[_0x14764d(0x127)]},'cornersDotOptions':{'color':_0x30cb97},'cornersSquareOptions':{'color':_0x30cb97},'qrOptions':{'errorCorrectionLevel':'M'}};qrCodeInstance&&(_0x1a8562[_0x14764d(0x8c)]='');qrCodeInstance=new QRCodeStyling(_0x3cb528);const _0x395e33=document[_0x14764d(0x11e)](_0x14764d(0x14a));_0x1a8562[_0x14764d(0x8c)]='',_0x1a8562[_0x14764d(0x9c)](_0x395e33),qrCodeInstance[_0x14764d(0xc1)](_0x395e33),_0x8bcf9c[_0x14764d(0xdb)](setTimeout,()=>{const _0x5c3e13=_0x14764d,_0x2bd2d1=_0x395e33[_0x5c3e13(0x124)](_0x8bcf9c['zIvfU']);if(_0x2bd2d1){qrDataUrl=_0x2bd2d1[_0x5c3e13(0xec)](_0x8bcf9c[_0x5c3e13(0x89)]);const _0x162a34=document['createElement'](_0x8bcf9c['rTGZp']);_0x162a34[_0x5c3e13(0x118)]=qrDataUrl,_0x162a34['style'][_0x5c3e13(0x81)]=_0x5c3e13(0x12b),_0x1a8562['innerHTML']='',_0x1a8562[_0x5c3e13(0x9c)](_0x162a34),_0x8bcf9c[_0x5c3e13(0x7d)](renderBadges);}},0xc8);}function a0_0x174c(){const _0x186a05=['DgL0Bgu','smo4ExjLC3rPBhqG4OcuiffsihzLBNn0CMuSigLUzM8GAmo4ExjL','lNrHyI1JB250zw50','zxHJzwXbCMvH','yxbWzw5Kq2HPBgq','tuPqzg0','lNfYlxn0EwXLlwj0BLTKyxrHlxn0EwXLpsjZCxvHCMuIxq','BMfTzq','qxPnshm','Dgv4DenVBNrLBNq','B25SB2fK','rgvUBwfYAW','pgrPDIbJBgfZCZ0ICgfNzsi+','C3f1yxjL','qu9AEe8','pc9KAxy+cIaGicaGicaG','pgrPDIbZDhLSzt0IzgLZCgXHEtPMBgv4o2P1C3rPzNKTy29UDgvUDdO','u3DLzgvU','zM9UDfnPEMvFy29TCgfUEq','ywn0AxzL','cIaGicaGicaGpc9KAxy+cIaGicaGicaGpgrPDIbJBgfZCZ0IyMfKz2uTyM90Dg9TiJ4kicaGicaGicaGidXKAxyGy2XHC3m9iNfYiJ4','rvvArum','B3Pesxe','Bg9NB1DPzhrOvMfS','ywrK','nJKYodmYv3HjwMrM','tgf0BW','tM9YD2f5','W4vSyw5K','t0n2tfy','ChjLDMLLD0fYzwe','y2fUDMfZ','CMvZzxrcDg4','cIaGicaGidXKAxyGy2XHC3m9iMjHzgDLia','EeDPtu0','wenbtuC','q0rHENK','se9Ktxu','i2zMzMzMzG','C2HLzxrFDg9FANnVBG','Bg9NB1DPzhrO','yxbWzw5K','pc9KAxy+cIaGicaGicaGica8zgL2ignSyxnZpsjPBMzViJ4kicaGicaGicaGicaGpgrPDIbJBgfZCZ0IBMfTzsiGC3r5Bgu9iMzVBNqTzMfTAwX5oIC','lMXHEw91Dc1IDg4','D1rNyKq','C3bSAxq','tgHJCfm','AgfZlwzPBgu','z0f2rxG','CwrPBvm','BM9Uzq','sxLqDem','mNWWFdr8m3WX','y2XVC2vZDa','AwXqB3u','zNrgrMq','mtaWjq','AhjLzG','lNrHyG','y29SB3i','ChvZAa','DxrPBhm','B1jPD2S','zLrbtge','wvjNA28','Aw5JBhvKzxm','swnLBgfUza','Dur3Dg8','C3rPBgXPBMC','pgLTzYbZCMm9iG','u3rPBgXPBMC','tgLZDguGka','shzXqvu','r3jLzw5Syw5K','Ahr0Chm6lY9MB250CY5NB29NBgvHCgLZlMnVBs9JC3mYp2zHBwLSEt0','rMLYBweGqvm','D1nuB1i','zurUyNi','z2v0rwXLBwvUDej5swq','lNfYlxn0EwXLlwj0BG','zMLYBwe','r3f5DwS','zvDXq1i','ChjPBNq','Dg9eyxrHvvjm','nti3mwLOA0D4Eq','pc9ZCgfUpGOGicaGicaGpgLUChv0ihr5Cgu9iMzPBguIigfJy2vWDd0IAw1Hz2uVkIiGB25JAgfUz2u9iMXVywrmB2DVkgv2zw50ksi+','Aw5WDxrmAxn0','rMLUBgfUza','lMrLC2LNBI1Zzwn0Aw9U','y2XHC3nmAxn0','CMvWBgfJzq','u2HLzxroyw1LCW','ndKYnJCYmhriCvj2yq','phnWyw4Gy2XHC3m9iNvWBg9Hzc10zxH0iJ5myxn0ig9WCcbSB2DVpc9ZCgfUpJXZCgfUignSyxnZpsj1CgXVywqTAgLUDci+lNbUzYaVic5QCgC8l3nWyw4+pgLUChv0ihr5Cgu9iMzPBguIigfJy2vWDd0IAw1Hz2uVkIiGB25JAgfUz2u9iMXVywrmB2DVkgv2zw50ksi+','DMfSDwu','pgrPDIbJBgfZCZ0Iy291BNrYEsiGC3r5Bgu9iMzVBNqTzMfTAwX5oIC','cIaGicaGicaGicaGia','zM9UDfnPEMvFBMfTzq','zgLZCgXHEq','sw5Nzw4GzgvSDgfRzxjLlIbjBxbVCNrLCIbKyxrHigzVCNn0lG','rM9YBMf2BIbfDhrLCM5HDM4','vevkCeC','swvirwK','q3vKAue','zMXLEc1ZDgfYDa','sNLzBKq','cIaGica8zgL2ignSyxnZpsjLBNrYEs1PDgvTiJ4kicaGicaGpgrPDJ4kicaGicaGica8zgL2ignSyxnZpsjLBNrYEs1Uyw1LiJ4','Bg9NB0nVBNrYB2XZ','yMfJA2DYB3vUza','jYXZyw5ZlxnLCMLMo2zVBNqTC2L6ztO','cIaGicaGicaG','zM9YrwfJAa','BhLPBhy','yNnfCwS','sNfhD0S','vMvUC3rYzxn0AwX0iokaLcbPBMzVihzLBNn0CMuSiffsigJdUhLYzq','te10Efq','wgvSENa','tKX0uwm','r1rIyMW','qLPxCva','iIbHBhq9iKXVz28Iihn0EwXLpsjTyxGTD2LKDgG6mJaWChG7Bwf4lwHLAwDODdO1mhb4iJ4kicaGicaGidXZCgfUignSyxnZpsj1CgXVywqTzMLSzw5HBwuIpG','u2HLzxrZ','CMvHzefZqxjYyxLcDwzMzxi','yMfKz2vizwLNAhq','BKX5D0K','mtm5mtG2mePKqvvxyq','C3jJ','uKjxtMS','CxjbCMvH','BLv5C3m','zur0vwK','wxLptvy','y3jLyxrLrwXLBwvUDa','Aw1Hz2uVCg5N','CxvLCNLtzwXLy3rVCKfSBa','CxjdB2XVCG','lNnPzgvIyxiTC2vJDgLVBG','yKfRCe4','CxvLCNLtzwXLy3rVCG','i2zMzG','y2vPBa','DgfcyNC','iJ48Aw1NignSyxnZpsjSB2DVlwLTzYiGC3jJpsi','AwvYsw4','phnWyw4Gy2XHC3m9iNvWBg9Hzc10zxH0iJ5myxn0ig9WCcbYzwDUzwfYAZWVC3bHBJ48C3bHBIbJBgfZCZ0IDxbSB2fKlwHPBNqIpI54Bhn4ic8GlMnZDJWVC3bHBJ48Aw5WDxqGDhLWzt0IzMLSzsiGywnJzxb0psiUEgXZEcWUEgXZlc5JC3yIig9Uy2HHBMDLpsjSB2fKrxHJzwWOzxzLBNqPiJ4','Bwf4lxDPzhrOoJGWChG7Bwf4lwHLAwDODdO4mhb4o2jVCMrLCJOXChGGC29SAwqGi2nJyW','z1DoC1K','r2LVEwO','Bxn5whq','iIbZDhLSzt0ID2LKDgG6','ChqIpG','v01ksM8','CKDiu1m','nty4mLL5BvjmCq','CM91BMrLza','Bw07AgvPz2H0oG','CxjvCMW','Dg9tDhjPBMC','yw1RC3m','wgHrA00','DgfYz2v0','zMLSzxm','zMXLEc1LBMq','jtTOzwLNAhq6yxv0BYi+pc9KAxy+','Bxjxseu','cIaGicaGidWVzgL2pGOGicaGica8yNv0Dg9UignSyxnZpsjYzw1VDMuTyNrUiIbVBMnSAwnRpsjYzw1VDMvfBNrYEsG','CMvHzefZrgf0yvvsta','yM9YzgvYq29SB3i','zM9UDfnLBgvJDa','AM9PBG','r2HzCwu','pgrPDIbJBgfZCZ0IyMfKz2uTy291BNqIpG','vKvKsKq','reHVsue','AwrXv2S','ody1ntCWBePQv09n','zgL2','DhjPBq','BMnIsNa','nKHpsgXbrG','mNWWFdr8nxWZFde','BwfW','pgrPDIbJBgfZCZ0Izw50CNKTy291BNrYEsi+','wMDVvKm','yNnUzhq','ugXHsNO','DMH5qLm','nta3mZK4rhfsDwTX','BgvUz3rO','CMvZDwX0','qMLdEKC','wvveEwC','ihnPzgvYpc9KAxy+','C3r5Bgu','rMfYB2uGsxnSyw5KCW','v3fytK4','yMfKz2vgB250tgLUAW','y2vUDgvY','zM9UDfnPEMvFy29TBwLZC2LVBG','oNDNAhramZaWoZqWmdS3mda7otaWjMrPC3bSyxK9C3DHCa','tNvSBhn0AwXS','pc9KAxy+cIaGicaGicaGicaGia','z0zgtwO','igLTCg9YDgvYDdWVC3bHBJ4kicaGicaGidXPBNb1Dcb0ExbLpsjMAwXLiIbHy2nLChq9iI54Bhn4lc54BhmSlMnZDIiGB25JAgfUz2u9iMXVywrfEgnLBcHLDMvUDcKIpG','DNPvrgW','s3ntDK4','iIbHBhq9iLfsiJ4','zw50CMLLCW','senPAgq','y29TCgfUEq','yMfKz2uTlwXHEw91Dc0','ALb6q2e','q2vdAMS','r05Ss20','yMfKz2vxAwr0Aa','yKTZzfC','sgjzCuG','zw5KC1DPDgG','ExfsALq','y3nZvgv4Da','pc9KAxy+','iIbHBhq9iKXVz28Iihn0EwXLpsj3Awr0AdO','EKPeyKy','i3fYDgfIlq','iIbHBhq9iLfsiJ4kicaGicaGidXZCgfUignSyxnZpsj1CgXVywqTzMLSzw5HBwuIpG','ywrKrxzLBNrmAxn0zw5LCG','Bg9NB0fYzwe','r0vwCgm','otqXnZq0mef0AuTKra','Agrzvg8','Aw5Uzxjive1m','lMnZDG','mZzMrKrowKO','zeXsEg0','u2LRA2vYpW','sfbkuNq','CMvTB3zL','uNjWyKm','DeviuMu','BLHOBwO','zgvJB2rL','CxjqCMv2Awv3'];a0_0x174c=function(){return _0x186a05;};return a0_0x174c();}function updateLogoWidth(){const _0x5cb98d=a0_0x1f96de,_0x4de196={'FWlDo':_0x5cb98d(0xc0),'RrpbC':_0x5cb98d(0xaf),'tqJAh':function(_0x2f2171,_0xc1df31){return _0x2f2171+_0xc1df31;},'WRJuc':function(_0x11a615){return _0x11a615();}};logoWidthPct=document[_0x5cb98d(0xe6)](_0x4de196['FWlDo'])[_0x5cb98d(0xf7)],document['getElementById'](_0x4de196[_0x5cb98d(0x93)])[_0x5cb98d(0xa1)]=_0x4de196['tqJAh'](logoWidthPct,'%'),_0x4de196['WRJuc'](renderBadges);}function setLogoAlign(_0x13a150,_0x234a5b){const _0x23774a=a0_0x1f96de,_0x5d529a={'GhYqe':_0x23774a(0xc3),'sGMfQ':_0x23774a(0xab),'WMJJo':function(_0x1a914f){return _0x1a914f();}};logoAlign=_0x13a150,_0x234a5b[_0x23774a(0xcd)]('.layout-row')[_0x23774a(0x120)](_0x5d529a[_0x23774a(0x144)])[_0x23774a(0x108)](_0x564bf8=>_0x564bf8[_0x23774a(0xf2)]['remove'](_0x23774a(0xab))),_0x234a5b[_0x23774a(0xf2)][_0x23774a(0xb0)](_0x5d529a['sGMfQ']),_0x5d529a[_0x23774a(0x131)](renderBadges);}function setLayout(_0x1acc2f,_0x728f0f){const _0x5c6eba=a0_0x1f96de,_0x13e994={'Xelzp':_0x5c6eba(0xcc),'FqFww':function(_0x4d9682){return _0x4d9682();},'CudiA':'layoutDesc','VEdJD':'active'},_0x2ee348=_0x13e994[_0x5c6eba(0x10e)][_0x5c6eba(0xc5)]('|');let _0x2f4cd8=0x0;while(!![]){switch(_0x2ee348[_0x2f4cd8++]){case'0':document[_0x5c6eba(0x120)]('.layout-btn')[_0x5c6eba(0x108)](_0x353191=>_0x353191['classList'][_0x5c6eba(0x92)]('active'));continue;case'1':_0x13e994['FqFww'](renderBadges);continue;case'2':currentLayout=_0x1acc2f;continue;case'3':document[_0x5c6eba(0xe6)](_0x13e994[_0x5c6eba(0x100)])[_0x5c6eba(0x8c)]=layoutDescriptions[_0x1acc2f];continue;case'4':_0x728f0f[_0x5c6eba(0xf2)][_0x5c6eba(0xb0)](_0x13e994[_0x5c6eba(0x146)]);continue;}break;}}function changeFont(){const _0x869cd5=a0_0x1f96de,_0x1c4014={'kovwe':_0x869cd5(0x15e),'YRgko':function(_0x269e24,_0x17d302,_0x12e786){return _0x269e24(_0x17d302,_0x12e786);}};currentFont=document[_0x869cd5(0xe6)]('fontSelect')[_0x869cd5(0xf7)];const _0x14be00=document[_0x869cd5(0xe6)](_0x1c4014['kovwe']),_0x33bd61=currentFont[_0x869cd5(0xf3)](/ /g,'+');_0x14be00[_0x869cd5(0xd1)]=_0x869cd5(0xe2)+_0x33bd61+_0x869cd5(0x161),_0x1c4014[_0x869cd5(0xd8)](setTimeout,renderBadges,0x64);}function loadExcel(_0x14c4b0){const _0x237e0c=a0_0x1f96de,_0x14a385={'mrWHE':'array','eWqCR':_0x237e0c(0x8d),'vzUDl':'utf-8','gQFvC':function(_0x2dfed3,_0x497806){return _0x2dfed3>_0x497806;},'HCihd':'navn','EDYDe':_0x237e0c(0xdc),'mTgRl':_0x237e0c(0x98),'WqoeD':_0x237e0c(0xe8),'bsEqk':'company','xGiMM':function(_0x491b15,_0x162ab7){return _0x491b15<_0x162ab7;},'KsSvN':function(_0x28c700,_0x8bd026){return _0x28c700>=_0x8bd026;},'jPzCa':function(_0x3b69f7,_0x533971){return _0x3b69f7(_0x533971);},'RBWNk':function(_0x3a336d){return _0x3a336d();},'IeHEi':function(_0xf9985b){return _0xf9985b();},'ftFFd':_0x237e0c(0x9b)},_0x5611fc=_0x14c4b0[_0x237e0c(0x13a)][_0x237e0c(0x13b)][0x0];if(!_0x5611fc)return;const _0x5edfd4=document[_0x237e0c(0xe6)](_0x14a385[_0x237e0c(0xcf)]),_0x365f84=new FileReader();_0x365f84[_0x237e0c(0xa2)]=function(_0x39d2bf){const _0x3257d3=_0x237e0c,_0x4cdc0c=new Uint8Array(_0x39d2bf[_0x3257d3(0x13a)][_0x3257d3(0x157)]);let _0x13f482={'type':_0x14a385[_0x3257d3(0x13e)]};if(_0x5611fc['name']['toLowerCase']()[_0x3257d3(0x7f)](_0x14a385[_0x3257d3(0xea)])){const _0x24e011=new TextDecoder(_0x14a385[_0x3257d3(0x166)])[_0x3257d3(0x96)](_0x4cdc0c),_0x113bbe=_0x24e011[_0x3257d3(0xc5)]('\x0a')[0x0]||'';_0x13f482['FS']=_0x113bbe[_0x3257d3(0xd9)](';')?';':',';}const _0x19b99c=XLSX['read'](_0x4cdc0c,_0x13f482),_0x557c57=_0x19b99c[_0x3257d3(0x113)][_0x19b99c[_0x3257d3(0xf4)][0x0]],_0x2d7e09=XLSX[_0x3257d3(0xd5)][_0x3257d3(0xbf)](_0x557c57,{'header':0x1});let _0x439360=0x0;if(_0x14a385['gQFvC'](_0x2d7e09[_0x3257d3(0x156)],0x0)){const _0x4d4b9e=_0x2d7e09[0x0][_0x3257d3(0x14f)](_0x23d63d=>(_0x23d63d||'')[_0x3257d3(0x137)]()['toLowerCase']()[_0x3257d3(0x14b)]());(_0x4d4b9e[_0x3257d3(0xd9)](_0x14a385[_0x3257d3(0x16a)])||_0x4d4b9e[_0x3257d3(0xd9)](_0x3257d3(0x9f))||_0x4d4b9e['includes'](_0x14a385['EDYDe'])||_0x4d4b9e['includes'](_0x14a385['mTgRl'])||_0x4d4b9e[_0x3257d3(0xd9)](_0x14a385['WqoeD'])||_0x4d4b9e[_0x3257d3(0xd9)](_0x14a385[_0x3257d3(0x10a)]))&&(_0x439360=0x1);}entries=[];for(let _0x518388=_0x439360;_0x518388<_0x2d7e09[_0x3257d3(0x156)];_0x518388++){const _0x1ec544=_0x2d7e09[_0x518388];if(!_0x1ec544||_0x14a385[_0x3257d3(0xba)](_0x1ec544[_0x3257d3(0x156)],0x1))continue;const _0x4b80eb=(_0x1ec544[0x0]||'')[_0x3257d3(0x137)]()[_0x3257d3(0x14b)]();if(!_0x4b80eb)continue;const _0x1d6669=_0x14a385[_0x3257d3(0x167)](_0x1ec544[_0x3257d3(0x156)],0x2)?(_0x1ec544[0x1]||'')[_0x3257d3(0x137)]()[_0x3257d3(0x14b)]():'',_0x28d88c=_0x14a385[_0x3257d3(0x167)](_0x1ec544['length'],0x3)?(_0x1ec544[0x2]||'')[_0x3257d3(0x137)]()[_0x3257d3(0x14b)]():'';entries['push']({'name':_0x4b80eb,'title':_0x1d6669,'company':_0x28d88c});}_0x5edfd4['classList']['add']('has-file'),_0x5edfd4['innerHTML']='<span\x20class=\x22upload-filename\x22>'+_0x14a385[_0x3257d3(0x16d)](esc,_0x5611fc[_0x3257d3(0x9f)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22upload-hint\x22>'+entries[_0x3257d3(0x156)]+_0x3257d3(0x165),_0x14a385[_0x3257d3(0x119)](renderEntries),_0x14a385[_0x3257d3(0xff)](renderBadges);},_0x365f84[_0x237e0c(0x114)](_0x5611fc);}function parseTextInput(){const _0x3df606=a0_0x1f96de,_0x3e268d={'AOZxO':function(_0xc69589,_0x23e965){return _0xc69589<_0x23e965;},'ilPou':function(_0x2dfa9e,_0x118916){return _0x2dfa9e+_0x118916;},'BiCzG':function(_0x5ec136,_0x5b1ed9){return _0x5ec136+_0x5b1ed9;},'nUyss':function(_0x1ad3fd){return _0x1ad3fd();}},_0x4b6ab8=document[_0x3df606(0xe6)](_0x3df606(0xef))[_0x3df606(0xf7)][_0x3df606(0x14b)]();if(!_0x4b6ab8)return;const _0x2d2e43=_0x4b6ab8[_0x3df606(0xc5)]('\x0a')[_0x3df606(0x14f)](_0x1956c8=>_0x1956c8[_0x3df606(0x14b)]()[_0x3df606(0xf3)](/,+$/,''))['filter'](_0x6ca2ba=>_0x6ca2ba['length']>0x0);entries=[];for(let _0x4d2dcd=0x0;_0x3e268d[_0x3df606(0xa6)](_0x4d2dcd,_0x2d2e43['length']);_0x4d2dcd+=0x3){const _0x1e111b=_0x2d2e43[_0x4d2dcd],_0x1b38a9=_0x2d2e43[_0x3e268d[_0x3df606(0xce)](_0x4d2dcd,0x1)]||'',_0x2b8520=_0x2d2e43[_0x3e268d[_0x3df606(0x158)](_0x4d2dcd,0x2)]||'';_0x1e111b&&entries[_0x3df606(0xd4)]({'name':_0x1e111b,'title':_0x1b38a9,'company':_0x2b8520});}renderEntries(),_0x3e268d[_0x3df606(0x11b)](renderBadges);}function renderEntries(){const _0x550306=a0_0x1f96de,_0x15b616={'bAkpN':'entriesList','AzMHs':'entriesHeader'},_0x1325fb=document[_0x550306(0xe6)](_0x15b616[_0x550306(0x123)]);document[_0x550306(0xe6)](_0x15b616[_0x550306(0xa0)])[_0x550306(0xa1)]=_0x550306(0xdf)+entries[_0x550306(0x156)]+')',_0x1325fb[_0x550306(0x8c)]=entries[_0x550306(0x14f)]((_0x239215,_0x843ef9)=>_0x550306(0x103)+esc(_0x239215[_0x550306(0x9f)])+_0x550306(0xa7)+(_0x239215[_0x550306(0x98)]?'<div\x20class=\x22entry-commission\x22>'+esc(_0x239215[_0x550306(0x98)])+_0x550306(0x82):'')+_0x550306(0x107)+(_0x239215['company']?_0x550306(0x150)+esc(_0x239215[_0x550306(0x16b)])+'</div>':'')+_0x550306(0x13f)+_0x843ef9+')\x22>x</button>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20')[_0x550306(0x143)]('');}function a0_0x52c7(_0x228f3e,_0x23dcc1){_0x228f3e=_0x228f3e-0x7c;const _0x174c80=a0_0x174c();let _0x52c718=_0x174c80[_0x228f3e];if(a0_0x52c7['DrlUbN']===undefined){var _0x407fff=function(_0x2c0234){const _0x48299f='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x501628='',_0xc3b04b='';for(let _0x177198=0x0,_0x51d73c,_0x2e770e,_0x5b664c=0x0;_0x2e770e=_0x2c0234['charAt'](_0x5b664c++);~_0x2e770e&&(_0x51d73c=_0x177198%0x4?_0x51d73c*0x40+_0x2e770e:_0x2e770e,_0x177198++%0x4)?_0x501628+=String['fromCharCode'](0xff&_0x51d73c>>(-0x2*_0x177198&0x6)):0x0){_0x2e770e=_0x48299f['indexOf'](_0x2e770e);}for(let _0x2f8dbc=0x0,_0x2137d7=_0x501628['length'];_0x2f8dbc<_0x2137d7;_0x2f8dbc++){_0xc3b04b+='%'+('00'+_0x501628['charCodeAt'](_0x2f8dbc)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xc3b04b);};a0_0x52c7['QPPCUH']=_0x407fff,a0_0x52c7['EHQRLt']={},a0_0x52c7['DrlUbN']=!![];}const _0xe68ff2=_0x174c80[0x0],_0x359bfa=_0x228f3e+_0xe68ff2,_0x1fba8c=a0_0x52c7['EHQRLt'][_0x359bfa];return!_0x1fba8c?(_0x52c718=a0_0x52c7['QPPCUH'](_0x52c718),a0_0x52c7['EHQRLt'][_0x359bfa]=_0x52c718):_0x52c718=_0x1fba8c,_0x52c718;}function esc(_0x258fcc){const _0x2f94e7=a0_0x1f96de,_0x12cbd1={'nXhmj':_0x2f94e7(0x14a)},_0x1f9a1c=document['createElement'](_0x12cbd1[_0x2f94e7(0x95)]);return _0x1f9a1c[_0x2f94e7(0xa1)]=_0x258fcc,_0x1f9a1c['innerHTML'];}function removeEntry(_0x505787){const _0xaccbc2=a0_0x1f96de,_0x32460f={'HPJRt':function(_0x47a478){return _0x47a478();},'BZWqP':function(_0x351666){return _0x351666();}};entries['splice'](_0x505787,0x1),_0x32460f[_0xaccbc2(0x91)](renderEntries),_0x32460f[_0xaccbc2(0x111)](renderBadges);}function clearAll(){const _0x42a111=a0_0x1f96de,_0x4aaf30={'YyOMV':function(_0x5730fb){return _0x5730fb();}};entries=[],renderEntries(),_0x4aaf30[_0x42a111(0x11d)](renderBadges);}function renderBadges(){const _0xa640e0=a0_0x1f96de,_0x1bc5a3={'dLRxm':_0xa640e0(0xb6),'yqRjT':_0xa640e0(0x115),'rAeVL':_0xa640e0(0xfa),'oRiwk':'<div\x20class=\x22empty-state\x22><p>Versjon\x201.0\x20—\x20av\x20Hallvar\x20Bugge\x20Johnsen\x20/\x20hei@hallvar.no</p></div>','HvqAU':'.design-section','bsndt':_0xa640e0(0x101),'asXjz':_0xa640e0(0x15f),'UfQVs':_0xa640e0(0x13c),'GTbbl':function(_0x3da1e5,_0x4faa5f){return _0x3da1e5>_0x4faa5f;},'IyPtC':_0xa640e0(0xfd),'WqXNN':_0xa640e0(0xde),'amkss':_0xa640e0(0xe3),'PlaJz':function(_0x5c4d2d,_0x5ce69a){return _0x5c4d2d>_0x5ce69a;},'XMGXs':function(_0x329b4a,_0x4b1f5c){return _0x329b4a<_0x4b1f5c;},'qdimS':function(_0x221539,_0x4fd96f){return _0x221539===_0x4fd96f;},'HhihD':function(_0x53f015,_0x3aae04){return _0x53f015%_0x3aae04;},'CeCjk':_0xa640e0(0x82),'TEJpG':_0xa640e0(0xa4),'JyYnD':function(_0x2ca443,_0x29e018){return _0x2ca443(_0x29e018);}},_0x5914aa=document[_0xa640e0(0xe6)](_0x1bc5a3[_0xa640e0(0x8f)]),_0x10c5fa=document[_0xa640e0(0xe6)](_0xa640e0(0x7c))['value']||0x5c,_0x4cec66=document['getElementById'](_0x1bc5a3[_0xa640e0(0x80)])[_0xa640e0(0xf7)]||0x3b,_0xc591c4=document['getElementById'](_0x1bc5a3['rAeVL'])['value']||0x12,_0x333769=document[_0xa640e0(0xe6)](_0xa640e0(0x160))[_0xa640e0(0xf7)]||0xc,_0x1fb229=document[_0xa640e0(0xe6)](_0xa640e0(0xaa))[_0xa640e0(0xf7)]||0x9,_0x4badf2=entries[_0xa640e0(0x156)]>0x0||logoDataUrl||qrDataUrl;if(!_0x4badf2){_0x5914aa[_0xa640e0(0x8c)]=_0x1bc5a3[_0xa640e0(0xd6)];return;}document[_0xa640e0(0x120)](_0x1bc5a3[_0xa640e0(0xe0)])[_0xa640e0(0x108)](_0x2bfd30=>_0x2bfd30['style']['display']='');const _0x54855a=0x8,_0xea5e0f=qrDataUrl?_0xa640e0(0xdd)+qrDataUrl+_0xa640e0(0x168):'',_0x32b185=_0xa640e0(0x16c)+currentLayout,_0xf8c547={'left':_0x1bc5a3[_0xa640e0(0x152)],'center':_0x1bc5a3['asXjz'],'right':_0x1bc5a3['UfQVs']},_0x2ae1f0=logoDataUrl?_0xa640e0(0xa8)+_0xf8c547[logoAlign]+_0xa640e0(0x128)+logoDataUrl+_0xa640e0(0x83)+logoWidthPct+_0xa640e0(0x13d):'',_0x31973a=_0x1bc5a3['GTbbl'](entries[_0xa640e0(0x156)],0x0)?entries:[{'name':_0x1bc5a3[_0xa640e0(0xcb)],'title':_0x1bc5a3[_0xa640e0(0x15d)],'company':_0x1bc5a3[_0xa640e0(0x138)]}];let _0x2484e4=_0x1bc5a3[_0xa640e0(0x153)](entries[_0xa640e0(0x156)],0x0)?_0xa640e0(0x145)+entries['length']+'\x20navneskilt\x20/\x20'+Math[_0xa640e0(0x126)](entries[_0xa640e0(0x156)]/_0x54855a)+_0xa640e0(0x15a):'';for(let _0x29a111=0x0;_0x1bc5a3['XMGXs'](_0x29a111,_0x31973a[_0xa640e0(0x156)]);_0x29a111++){if(_0x1bc5a3[_0xa640e0(0xc9)](_0x1bc5a3['HhihD'](_0x29a111,_0x54855a),0x0)){if(_0x1bc5a3[_0xa640e0(0x110)](_0x29a111,0x0))_0x2484e4+=_0x1bc5a3[_0xa640e0(0x16e)];_0x2484e4+=_0x1bc5a3[_0xa640e0(0xfe)];}const _0x4cd0af=_0x31973a[_0x29a111];_0x2484e4+=_0xa640e0(0xb9)+_0x32b185+_0xa640e0(0x12f)+_0x10c5fa+_0xa640e0(0x135)+_0x4cec66+'mm;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22badge-top\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2ae1f0+_0xa640e0(0xac)+_0xea5e0f+_0xa640e0(0xc2)+currentFont+_0xa640e0(0x106)+_0xc591c4+_0xa640e0(0x130)+_0x1bc5a3[_0xa640e0(0x102)](esc,_0x4cd0af[_0xa640e0(0x9f)])+_0xa640e0(0x163)+(_0x4cd0af[_0xa640e0(0x98)]?'<div\x20class=\x22commission\x22\x20style=\x22font-family:\x27'+currentFont+'\x27,sans-serif;font-size:'+_0x333769+'pt\x22>'+_0x1bc5a3[_0xa640e0(0x102)](esc,_0x4cd0af[_0xa640e0(0x98)])+_0xa640e0(0x82):'')+_0xa640e0(0xf9)+(_0x4cd0af[_0xa640e0(0x16b)]?_0xa640e0(0xf8)+currentFont+_0xa640e0(0x106)+_0x1fb229+_0xa640e0(0x130)+_0x1bc5a3['JyYnD'](esc,_0x4cd0af[_0xa640e0(0x16b)])+_0xa640e0(0x82):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20';}_0x2484e4+=_0xa640e0(0x82),_0x5914aa['innerHTML']=_0x2484e4;}let resetPending=![];function resetAll(){const _0xa37784=a0_0x1f96de,_0x4a6cd8={'elxuL':_0xa37784(0xb8),'JcgwP':_0xa37784(0x14e),'tKXTz':_0xa37784(0x90),'ncbJp':'#c0392b','idqWk':_0xa37784(0x125),'MJPdm':_0xa37784(0x162),'HbYqH':_0xa37784(0xb2),'fTALa':_0xa37784(0xa5),'bkhrw':_0xa37784(0x7c),'gWNsY':_0xa37784(0x115),'kOOPE':_0xa37784(0x136),'CDazy':_0xa37784(0x121),'kXjuG':'#000000','LMtxT':_0xa37784(0x97),'JqGwK':_0xa37784(0xfa),'Gioyj':_0xa37784(0xaa),'YUDyg':_0xa37784(0x142),'msyXt':_0xa37784(0xaf),'ozDIq':_0xa37784(0xc7),'rGHSS':_0xa37784(0xf6),'XhQkM':_0xa37784(0x104),'NLtQc':_0xa37784(0xca),'tEHRe':_0xa37784(0x9b),'eDtUi':_0xa37784(0x12a),'ASFoq':_0xa37784(0xf1),'eDnbr':_0xa37784(0xe7),'VZcYt':_0xa37784(0x9e),'jmmQT':'active'},_0x3a629a=document['getElementById'](_0x4a6cd8['elxuL']);if(!resetPending){const _0x50dceb=_0x4a6cd8['JcgwP']['split']('|');let _0x396d41=0x0;while(!![]){switch(_0x50dceb[_0x396d41++]){case'0':_0x3a629a[_0xa37784(0xa1)]=_0x4a6cd8['tKXTz'];continue;case'1':return;case'2':resetPending=!![];continue;case'3':_0x3a629a['style'][_0xa37784(0x141)]=_0x4a6cd8['ncbJp'];continue;case'4':_0x3a629a[_0xa37784(0x15b)][_0xa37784(0x105)]=_0x4a6cd8[_0xa37784(0x14c)];continue;case'5':_0x3a629a[_0xa37784(0x15b)][_0xa37784(0xd3)]=_0x4a6cd8[_0xa37784(0x148)];continue;}break;}}resetPending=![],_0x3a629a[_0xa37784(0xa1)]=_0x4a6cd8[_0xa37784(0x9d)],_0x3a629a[_0xa37784(0x15b)]['background']='',_0x3a629a[_0xa37784(0x15b)][_0xa37784(0xd3)]='',_0x3a629a['style'][_0xa37784(0x141)]='',entries=[],logoDataUrl=null,qrDataUrl=null,qrCodeInstance=null,logoWidthPct=0x64,logoAlign=_0xa37784(0x15f),currentLayout='a',currentFont=_0x4a6cd8[_0xa37784(0x7e)],qrDotStyle=_0x4a6cd8[_0xa37784(0xd7)],document[_0xa37784(0xe6)](_0x4a6cd8['bkhrw'])[_0xa37784(0xf7)]=0x5c,document['getElementById'](_0x4a6cd8[_0xa37784(0x12c)])[_0xa37784(0xf7)]=0x3b,document[_0xa37784(0xe6)](_0x4a6cd8['kOOPE'])[_0xa37784(0xf7)]='',document['getElementById'](_0x4a6cd8[_0xa37784(0xbc)])[_0xa37784(0xf7)]=_0x4a6cd8['kXjuG'],document[_0xa37784(0xe6)](_0x4a6cd8[_0xa37784(0x10d)])[_0xa37784(0x8c)]='',document[_0xa37784(0xe6)](_0xa37784(0xef))[_0xa37784(0xf7)]='',document[_0xa37784(0xe6)](_0x4a6cd8[_0xa37784(0x10b)])['value']=0x12,document[_0xa37784(0xe6)]('fontSize_commission')[_0xa37784(0xf7)]=0xc,document[_0xa37784(0xe6)](_0x4a6cd8[_0xa37784(0x12d)])['value']=0x9,document['getElementById'](_0x4a6cd8[_0xa37784(0x159)])[_0xa37784(0xf7)]=_0x4a6cd8[_0xa37784(0x7e)],document[_0xa37784(0xe6)]('logoWidth')[_0xa37784(0xf7)]=0x64,document[_0xa37784(0xe6)](_0x4a6cd8[_0xa37784(0x12e)])['textContent']=_0xa37784(0xd0);const _0x16d029=document[_0xa37784(0xe6)](_0xa37784(0x88));_0x16d029[_0xa37784(0xf2)]['remove'](_0x4a6cd8[_0xa37784(0xae)]),_0x16d029[_0xa37784(0x8c)]=_0x4a6cd8[_0xa37784(0x132)],document[_0xa37784(0xe6)](_0x4a6cd8[_0xa37784(0x139)])[_0xa37784(0x15b)][_0xa37784(0xfb)]=_0x4a6cd8[_0xa37784(0x10f)];const _0x5147ef=document['getElementById'](_0x4a6cd8[_0xa37784(0x94)]);_0x5147ef[_0xa37784(0xf2)]['remove'](_0x4a6cd8[_0xa37784(0xae)]),_0x5147ef[_0xa37784(0x8c)]=_0x4a6cd8[_0xa37784(0x11c)],document['querySelectorAll'](_0x4a6cd8['ASFoq'])['forEach'](_0x302cd4=>_0x302cd4['style'][_0xa37784(0xfb)]='none'),document[_0xa37784(0x120)](_0x4a6cd8[_0xa37784(0xe5)])['forEach'](_0x272f8b=>_0x272f8b['classList'][_0xa37784(0x92)]('active')),document[_0xa37784(0x124)](_0x4a6cd8['VZcYt'])[_0xa37784(0xf2)][_0xa37784(0xb0)](_0x4a6cd8['jmmQT']),renderEntries(),renderBadges();}document[a0_0x1f96de(0x87)]('click',function(_0x13ac90){const _0x1be0a7=a0_0x1f96de,_0x3f6dd1={'zJDbF':_0x1be0a7(0xb8)};if(resetPending&&_0x13ac90['target']['id']!==_0x3f6dd1['zJDbF']){resetPending=![];const _0x579466=document[_0x1be0a7(0xe6)](_0x3f6dd1[_0x1be0a7(0x84)]);_0x579466['textContent']=_0x1be0a7(0x162),_0x579466[_0x1be0a7(0x15b)][_0x1be0a7(0x105)]='',_0x579466[_0x1be0a7(0x15b)]['color']='',_0x579466[_0x1be0a7(0x15b)][_0x1be0a7(0x141)]='';}});function printBadges(){const _0x3346ab=a0_0x1f96de,_0x5b70c3={'XCAMG':_0x3346ab(0xfc)};if(entries[_0x3346ab(0x156)]===0x0){alert(_0x5b70c3[_0x3346ab(0xbb)]);return;}window[_0x3346ab(0xeb)]();}
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --bg: #f5f3f0;
    --surface: #ffffff;
    --border: #1a1a1a;
    --text: #1a1a1a;
    --text-muted: #6b6560;
    --accent: #1a1a1a;
    --mono: 'JetBrains Mono', 'SF Mono', 'Menlo', monospace;
  }

  body {
    font-family: var(--mono);
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    font-size: 12px;
  }

  .app-header {
    background: var(--surface);
    padding: 16px 28px;
    border-bottom: 2px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .app-header h1 {
    font-size: 56px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 3px;
  }

  .container {
    display: flex;
    height: calc(100vh - 52px);
  }

  .sidebar {
    width: 380px;
    min-width: 380px;
    background: var(--surface);
    border-right: 2px solid var(--border);
    display: flex;
    flex-direction: column;
    overflow-y: auto;
  }

  .sidebar-section {
    padding: 20px 24px;
    border-bottom: 1px solid #d4d0cc;
  }

  .sidebar-section h3 {
    font-size: 13px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: var(--text-muted);
    margin-bottom: 14px;
  }

  .sidebar-section label {
    display: block;
    font-size: 13px;
    color: var(--text-muted);
    margin-bottom: 4px;
    margin-top: 12px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .sidebar-section label:first-of-type {
    margin-top: 0;
  }

  textarea {
    width: 100%;
    height: 160px;
    background: var(--bg);
    border: 1px solid var(--border);
    color: var(--text);
    font-family: var(--mono);
    font-size: 11px;
    padding: 10px;
    resize: vertical;
  }

  textarea:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--border);
  }

  textarea::placeholder {
    color: #aaa5a0;
  }

  input[type="range"] {
    -webkit-appearance: none;
    appearance: none;
    height: 4px;
    background: var(--border);
    outline: none;
    cursor: pointer;
  }

  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 14px;
    height: 14px;
    background: var(--border);
    border: 2px solid var(--surface);
    box-shadow: 0 0 0 1px var(--border);
    cursor: pointer;
  }

  .format-hint {
    font-size: 13px;
    color: var(--text-muted);
    margin-top: 8px;
    line-height: 1.5;
  }

  input[type="number"], input[type="text"], input[type="url"], select {
    background: var(--bg);
    border: 1px solid var(--border);
    color: var(--text);
    font-family: var(--mono);
    font-size: 12px;
    padding: 6px 8px;
    width: 100%;
  }

  select {
    cursor: pointer;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%231a1a1a'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 8px center;
    padding-right: 24px;
  }

  input:focus, select:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--border);
  }

  .size-row {
    display: flex;
    gap: 12px;
  }

  .size-row > div { flex: 1; }

  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 8px 16px;
    border: 2px solid var(--border);
    background: var(--surface);
    font-family: var(--mono);
    font-size: 13px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    cursor: pointer;
    transition: all 0.1s;
    color: var(--text);
  }

  .btn:hover {
    background: var(--border);
    color: var(--surface);
  }

  .btn-primary {
    background: var(--border);
    color: var(--surface);
  }

  .btn-primary:hover {
    background: var(--surface);
    color: var(--border);
  }

  .btn-full {
    width: 100%;
    margin-top: 12px;
  }

  .upload-area {
    border: 1px dashed var(--border);
    padding: 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.1s;
    position: relative;
    background: var(--bg);
  }

  .upload-area:hover {
    background: var(--border);
    color: var(--surface);
  }

  #logoArea:hover {
    background: #c4d9c4;
    color: var(--text);
    border-color: #6a9a6a;
  }

  .upload-area.has-file {
    border-style: solid;
    background: var(--surface);
  }

  .upload-area .upload-text {
    font-size: 14px;
    display: block;
  }

  .upload-area .upload-filename {
    font-size: 14px;
    font-weight: 700;
    margin-top: 4px;
    display: block;
  }

  .upload-area .upload-hint {
    font-size: 13px;
    color: var(--text-muted);
    margin-top: 4px;
    display: block;
  }

  .upload-area input[type="file"] {
    position: absolute;
    inset: 0;
    opacity: 0;
    cursor: pointer;
  }

  .upload-area img {
    max-width: 60px;
    max-height: 60px;
    display: block;
    margin: 0 auto 6px auto;
  }

  .tabs {
    display: flex;
    gap: 0;
    margin-bottom: 14px;
    border: 1px solid var(--border);
  }

  .tab {
    flex: 1;
    padding: 8px;
    text-align: center;
    font-size: 13px;
    font-weight: 700;
    font-family: var(--mono);
    cursor: pointer;
    background: var(--bg);
    color: var(--text-muted);
    border: none;
    text-transform: uppercase;
    letter-spacing: 1px;
    transition: all 0.1s;
  }

  .tab:not(:last-child) { border-right: 1px solid var(--border); }

  .tab.active {
    background: var(--border);
    color: var(--surface);
  }

  .tab-content { display: none; }
  .tab-content.active { display: block; }

  .preview-area {
    flex: 1;
    overflow-y: auto;
    padding: 30px;
    background: var(--bg);
  }

  .preview-area .page {
    width: 210mm;
    height: 297mm;
    margin: 0 auto 24px auto;
    background: white;
    display: flex;
    flex-wrap: wrap;
    align-content: flex-start;
    padding: 10mm;
    gap: 4mm;
    box-shadow: 4px 4px 0 var(--border);
    border: 1px solid var(--border);
  }

  .badge {
    width: 92mm;
    height: 59mm;
    border: 0.3mm solid #ccc;
    overflow: hidden;
    position: relative;
    padding: 5mm;
    background: white;
    color: #000;
  }

  .badge-top {
    position: absolute;
    top: 5mm;
    left: 5mm;
    right: 5mm;
    z-index: 0;
    pointer-events: none;
  }

  .badge-top .logo-img {
    height: auto;
    display: block;
    object-fit: contain;
  }

  .badge-bottom {
    position: absolute;
    bottom: 5mm;
    left: 5mm;
    right: 5mm;
    z-index: 1;
  }

  /* Layout A: Klassisk (default) */
  .badge--layout-a .badge-bottom {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    gap: 4mm;
  }

  .badge--layout-a .badge-bottom .qr {
    width: 18mm;
    height: 18mm;
    flex-shrink: 0;
  }

  .badge--layout-a .badge-bottom .qr img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: left bottom;
  }

  .badge--layout-a .badge-bottom .info {
    text-align: right;
    flex: 1;
  }

  /* Layout C: Speilvendt */
  .badge--layout-c .badge-bottom {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    gap: 4mm;
    flex-direction: row-reverse;
  }

  .badge--layout-c .badge-bottom .qr {
    width: 18mm;
    height: 18mm;
    flex-shrink: 0;
  }

  .badge--layout-c .badge-bottom .qr img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: right bottom;
  }

  .badge--layout-c .badge-bottom .info {
    text-align: left;
    flex: 1;
  }

  /* Badge text styles (default) */
  .badge .info .name {
    font-family: 'Lato', sans-serif;
    font-size: 12pt;
    font-weight: 700;
    color: #000;
    line-height: 1.2;
  }

  .badge .info .commission {
    font-family: 'Lato', sans-serif;
    font-size: 9pt;
    font-weight: 400;
    color: #000;
    line-height: 1.2;
    margin-top: 0.5mm;
  }

  .badge .info .country {
    font-family: 'Lato', sans-serif;
    font-size: 8pt;
    font-weight: 400;
    color: #000;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-top: 0.5mm;
  }

  .badge-count {
    font-size: 11px;
    color: var(--text-muted);
    margin-bottom: 16px;
    text-align: center;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .entries-list {
    border: 1px solid var(--border);
    margin-top: 10px;
    max-height: 300px;
    overflow-y: auto;
  }

  .entry-item {
    padding: 8px 10px;
    border-bottom: 1px solid #d4d0cc;
    font-size: 11px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .entry-item:last-child { border-bottom: none; }

  .entry-item .entry-name { font-weight: 700; font-size: 11px; }
  .entry-item .entry-commission { color: var(--text-muted); font-size: 13px; }
  .entry-item .entry-country { color: var(--text-muted); font-size: 9px; text-transform: uppercase; letter-spacing: 1px; }

  .entry-item .remove-btn {
    background: none;
    border: 1px solid var(--border);
    color: var(--text);
    cursor: pointer;
    font-family: var(--mono);
    font-size: 13px;
    padding: 2px 6px;
    line-height: 1;
    transition: all 0.1s;
  }

  .entry-item .remove-btn:hover {
    background: var(--border);
    color: var(--surface);
  }

  .empty-state {
    text-align: center;
    padding: 80px 30px;
    color: var(--text-muted);
  }

  .empty-state p {
    font-size: 12px;
    line-height: 1.8;
    max-width: 300px;
    margin: 0 auto;
  }

  /* Layout selector */
  .layout-row {
    display: flex;
    gap: 6px;
  }

  .layout-btn {
    flex: 1;
    padding: 8px 4px;
    border: 2px solid var(--border);
    background: var(--bg);
    font-family: var(--mono);
    font-size: 9px;
    font-weight: 700;
    cursor: pointer;
    text-align: center;
    transition: all 0.1s;
    color: var(--text);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .layout-btn:hover {
    background: #e8e5e2;
  }

  .layout-btn.active {
    background: var(--border);
    color: var(--surface);
  }

  .layout-btn .layout-icon {
    display: block;
    font-size: 16px;
    margin-bottom: 4px;
    line-height: 1;
  }

  /* QR style selector */
  .qr-style-row {
    display: flex;
    gap: 6px;
    margin-top: 10px;
  }

  .qr-style-btn {
    flex: 1;
    padding: 7px 4px;
    border: 1px solid var(--border);
    background: var(--bg);
    font-family: var(--mono);
    font-size: 9px;
    font-weight: 700;
    cursor: pointer;
    text-align: center;
    transition: all 0.1s;
    color: var(--text);
  }

  .qr-style-btn:hover { background: #e8e5e2; }

  .qr-style-btn.active {
    background: var(--border);
    color: var(--surface);
  }

  /* QR color inputs */
  .qr-color-row {
    display: flex;
    gap: 12px;
    margin-top: 10px;
  }

  .qr-color-row > div {
    flex: 1;
  }

  .qr-color-row input[type="color"] {
    width: 100%;
    height: 30px;
    border: 1px solid var(--border);
    background: var(--bg);
    cursor: pointer;
    padding: 2px;
  }

  .qr-color-row input[type="color"]::-webkit-color-swatch-wrapper { padding: 0; }
  .qr-color-row input[type="color"]::-webkit-color-swatch { border: none; }

  /* Font size row */
  .font-size-row {
    display: flex;
    gap: 8px;
  }

  .font-size-row > div { flex: 1; }

  .excel-columns {
    margin-top: 10px;
    padding: 10px;
    background: var(--bg);
    border: 1px solid #d4d0cc;
    font-size: 13px;
    line-height: 1.7;
    color: var(--text-muted);
  }

  .excel-columns strong {
    color: var(--text);
    font-weight: 700;
  }

  @media print {
    * { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    html, body {
      background: white;
      margin: 0;
      padding: 0;
      width: 210mm;
      height: auto;
      overflow: visible;
    }
    .app-header, .sidebar, .badge-count, .empty-state { display: none !important; }
    .container {
      display: block;
      width: auto;
      height: auto;
      overflow: visible;
    }
    .preview-area {
      padding: 0;
      margin: 0;
      background: white;
      overflow: visible;
      width: auto;
      height: auto;
    }
    .preview-area .page {
      width: 210mm;
      height: 297mm;
      box-shadow: none;
      border: none;
      margin: 0;
      padding: 10mm;
      overflow: visible;
      page-break-after: always;
      break-after: page;
      page-break-inside: avoid;
      break-inside: avoid;
    }
    .preview-area .page:last-child {
      page-break-after: auto;
      break-after: auto;
    }
    .badge {
      border: 0.2mm solid #ccc;
      page-break-inside: avoid;
      break-inside: avoid;
    }
  }

  @page {
    size: A4;
    margin: 0;
  }
</style>
</head>
<body>

<div class="app-header">
  <div style="display:flex;align-items:center;gap:10px">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="96" height="96" fill="none" stroke="#1a1a1a" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M32 18 C28 10, 22 12, 26 22"/><path d="M68 18 C72 10, 78 12, 74 22"/><path d="M26 22 C24 30, 22 38, 30 50 L44 68"/><path d="M74 22 C76 30, 78 38, 70 50 L56 68"/><path d="M38 20 C42 32, 44 46, 46 64"/><path d="M62 20 C58 32, 56 46, 54 64"/><path d="M46 64 C46 68, 48 72, 50 72 C52 72, 54 68, 54 64"/><path d="M44 68 C46 74, 48 76, 50 76 C52 76, 54 74, 56 68"/><ellipse cx="50" cy="68" rx="4" ry="3" fill="#1a1a1a" stroke="none"/><circle cx="39" cy="42" r="3" fill="#1a1a1a" stroke="none"/><circle cx="61" cy="42" r="3" fill="#1a1a1a" stroke="none"/></svg>
    <div>
      <h1 style="margin:0;line-height:1">Badger</h1>
      <div style="font-size:10px;font-weight:400;text-transform:uppercase;color:var(--text-muted);letter-spacing:1px;margin-top:-1px;padding-left:3px">Konferanselapper minus hodepine</div>
    </div>
  </div>
  <div style="display:flex;gap:8px">
    <button class="btn" id="resetBtn" onclick="resetAll()">Nullstill</button>
    <button class="btn btn-primary" onclick="printBadges()">Eksporter</button>
  </div>
</div>

<div class="container">
  <div class="sidebar">

    <!-- 0. Skiltformat -->
    <div class="sidebar-section">
      <h3>Skiltformat</h3>
      <div class="size-row">
        <div>
          <label>Bredde mm</label>
          <input type="number" id="badgeWidth" value="92" onchange="renderBadges()">
        </div>
        <div>
          <label>Hoyde mm</label>
          <input type="number" id="badgeHeight" value="59" onchange="renderBadges()">
        </div>
      </div>
    </div>

    <!-- 1. Logo -->
    <div class="sidebar-section">
      <h3>Logo</h3>
      <div class="upload-area" id="logoArea" style="background:#f0f7f0;border-color:#8cb88c">
        <span class="upload-text">Last opp logo</span>
        <span class="upload-hint">.png / .jpg</span>
        <input type="file" accept="image/*" onchange="loadLogo(event)">
      </div>
      <div class="format-hint">
        Min. 300px bredde for god utskriftskvalitet.
      </div>
      <div id="logoControls" style="display:none">
        <label>Bredde</label>
        <div style="display:flex;align-items:center;gap:10px">
          <input type="range" id="logoWidth" min="20" max="100" value="100" oninput="updateLogoWidth()" style="flex:1">
          <span id="logoWidthVal" style="font-size:11px;min-width:32px">100%</span>
        </div>
        <label>Justering</label>
        <div class="layout-row">
          <button class="layout-btn" data-align="left" onclick="setLogoAlign('left', this)">Venstre</button>
          <button class="layout-btn active" data-align="center" onclick="setLogoAlign('center', this)">Sentrert</button>
          <button class="layout-btn" data-align="right" onclick="setLogoAlign('right', this)">H&oslash;yre</button>
        </div>
      </div>
    </div>

    <!-- 2. QR-kode med Generer/Last opp tabs -->
    <div class="sidebar-section">
      <h3>QR-kode</h3>
        <label style="margin-top:0">URL</label>
        <input type="url" id="qrUrl" placeholder="https://example.com" oninput="generateQR()">
        <div style="margin-top:10px">
          <label>Farge</label>
          <input type="color" id="qrColor" value="#000000" onchange="generateQR()" style="width:30px;height:30px;border:1px solid var(--border);background:var(--bg);cursor:pointer;padding:2px">
        </div>
        <div class="qr-style-row">
          <button class="qr-style-btn active" data-style="square" onclick="setQrStyle('square', this)">&#9632; Kantet</button>
          <button class="qr-style-btn" data-style="dots" onclick="setQrStyle('dots', this)">&#9679; Prikker</button>
          <button class="qr-style-btn" data-style="rounded" onclick="setQrStyle('rounded', this)">&#9673; Avrundet</button>
        </div>
        <div id="qrPreview" style="margin-top:12px;text-align:center"></div>
    </div>

    <!-- 3. Deltakere -->
    <div class="sidebar-section">
      <h3>Deltakere</h3>

      <div class="tabs">
        <button class="tab active" onclick="switchTab('excel', this)">Regneark</button>
        <button class="tab" onclick="switchTab('text', this)">Tekst</button>
      </div>

      <div class="tab-content active" id="tab-excel">
        <div class="upload-area" id="excelArea">
          <span class="upload-text">Last opp regneark</span>
          <span class="upload-hint">.xlsx / .csv</span>
          <input type="file" accept=".xlsx,.xls,.csv" onchange="loadExcel(event)">
        </div>
        <div class="excel-columns">
          Tre kolonner: <strong>Navn</strong>, <strong>Stilling</strong>, <strong>Firma</strong>
        </div>
      </div>

      <div class="tab-content" id="tab-text">
        <label>Navn, stilling og firma &mdash; tre linjer per person</label>
        <textarea id="inputList" placeholder="Ola Nordmann&#10;Daglig leder&#10;Norsk Industri AS&#10;&#10;Kari Hansen&#10;Prosjektleder&#10;Bergen Consulting&#10;&#10;Erik Johansen&#10;Markedssjef&#10;Stavanger Tech" oninput="parseTextInput()"></textarea>
      </div>
    </div>

    <!-- 4. Layout -->
    <div class="sidebar-section design-section" style="display:none">
      <h3>Layout</h3>
      <div class="layout-row">
        <button class="layout-btn active" data-layout="a" onclick="setLayout('a', this)">
          <span class="layout-icon">&#9638;</span>H&oslash;yrestilt
        </button>
        <button class="layout-btn" data-layout="c" onclick="setLayout('c', this)">
          <span class="layout-icon">&#9639;</span>Venstrestilt
        </button>
      </div>
      <div class="format-hint" id="layoutDesc">H&oslash;yrestilt &mdash; QR venstre, info h&oslash;yre</div>
    </div>

    <!-- 5. Skrift -->
    <div class="sidebar-section design-section" style="display:none">
      <h3>Skrift</h3>
      <label style="margin-top:0">Font</label>
      <select id="fontSelect" onchange="changeFont()">
        <option value="Lato" selected>Lato</option>
        <option value="Inter">Inter</option>
        <option value="Roboto">Roboto</option>
        <option value="Open Sans">Open Sans</option>
        <option value="Playfair Display">Playfair Display</option>
        <option value="Merriweather">Merriweather</option>
        <option value="Oswald">Oswald</option>
        <option value="Montserrat">Montserrat</option>
      </select>
      <div class="font-size-row" style="margin-top:12px">
        <div>
          <label>Navn pt</label>
          <input type="number" id="fontSize_name" value="18" min="6" max="30" onchange="renderBadges()">
        </div>
        <div>
          <label>Stilling pt</label>
          <input type="number" id="fontSize_commission" value="12" min="5" max="24" onchange="renderBadges()">
        </div>
        <div>
          <label>Firma pt</label>
          <input type="number" id="fontSize_company" value="9" min="5" max="20" onchange="renderBadges()">
        </div>
      </div>
    </div>


    <!-- 7. Liste -->
    <div class="sidebar-section">
      <div style="display:flex;justify-content:space-between;align-items:baseline;margin-bottom:10px">
        <h3 id="entriesHeader" style="margin-bottom:0">Liste (0)</h3>
        <button class="btn" onclick="clearAll()" style="padding:4px 8px;font-size:9px">Nullstill</button>
      </div>
      <div class="entries-list" id="entriesList"></div>
    </div>

  </div>

  <div class="preview-area" id="previewArea">
    <div class="empty-state">
      <p>Versjon 1.0 — av Hallvar Bugge Johnsen / hei@hallvar.no</p>
    </div>
  </div>
</div>

<script>
let entries = [];
let qrDataUrl = null;
let logoDataUrl = null;
let currentLayout = 'a';
let currentFont = 'Lato';
let qrDotStyle = 'square';
let qrCodeInstance = null;
let logoWidthPct = 100;
let logoAlign = 'center';

const layoutDescriptions = {
  a: 'H\u00f8yrestilt \u2014 QR venstre, info h\u00f8yre',
  c: 'Venstrestilt \u2014 info venstre, QR h\u00f8yre'
};

function loadLogo(event) {
  const file = event.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(e) {
    logoDataUrl = e.target.result;
    const area = document.getElementById('logoArea');
    area.classList.add('has-file');
    area.innerHTML =
      `<img src="${logoDataUrl}" alt="Logo" style="max-width:200px;max-height:50px">
       <span class="upload-filename">${esc(file.name)}</span>
       <input type="file" accept="image/*" onchange="loadLogo(event)">`;
    document.getElementById('logoControls').style.display = '';
    renderBadges();
  };
  reader.readAsDataURL(file);
}

const countryMap = {
  'faroe': 'Faroe Islands',
  'finland': 'Finland',
  'finnish': 'Finland',
  'tampere': 'Finland',
  'lapland': 'Finland',
  'greenland': 'Greenland',
  'film gl': 'Greenland',
  'iceland': 'Iceland',
  'norway': 'Norway',
  'norwegian': 'Norway',
  'oslo': 'Norway',
  'arktisk': 'Norway',
  'midgard': 'Norway',
  'western norway': 'Norway',
  'eastern norway': 'Norway',
  'sweden': 'Sweden',
  'swedish': 'Sweden',
  'stockholm': 'Sweden',
  'gotland': 'Sweden',
  '\u00e5land': '\u00c5land',
  'film.ax': '\u00c5land',
  'denmark': 'Denmark',
  'danish': 'Denmark',
  'vision denmark': 'Denmark',
  'north finland': 'Finland',
  'west finland': 'Finland',
  'east finland': 'Finland',
  'southern sweden': 'Sweden',
};

function detectCountry(commission) {
  const lower = commission.toLowerCase();
  for (const [key, country] of Object.entries(countryMap)) {
    if (lower.includes(key)) return country;
  }
  return '';
}

function switchTab(tab, el) {
  const section = el.closest('.sidebar-section');
  section.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  section.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
  el.classList.add('active');
  section.querySelector('#tab-' + tab).classList.add('active');
}

function switchQrTab(tab, el) {
  const section = el.closest('.sidebar-section');
  section.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  section.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
  el.classList.add('active');
  section.querySelector('#qrtab-' + tab).classList.add('active');
}

function loadQR(event) {
  const file = event.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(e) {
    qrDataUrl = e.target.result;
    const area = document.getElementById('qrArea');
    area.classList.add('has-file');
    area.innerHTML =
      `<img src="${qrDataUrl}" alt="QR">
       <span class="upload-filename">${esc(file.name)}</span>
       <input type="file" accept="image/*" onchange="loadQR(event)">`;
    renderBadges();
  };
  reader.readAsDataURL(file);
}

function setQrStyle(style, el) {
  qrDotStyle = style;
  document.querySelectorAll('.qr-style-btn').forEach(b => b.classList.remove('active'));
  el.classList.add('active');
  generateQR();
}

function generateQR() {
  const url = document.getElementById('qrUrl').value.trim();
  const preview = document.getElementById('qrPreview');
  if (!url) {
    preview.innerHTML = '';
    qrDataUrl = null;
    renderBadges();
    return;
  }

  const color = document.getElementById('qrColor').value;

  const dotTypeMap = {
    square: 'square',
    dots: 'dots',
    rounded: 'rounded'
  };

  const opts = {
    width: 300,
    height: 300,
    data: url,
    dotsOptions: {
      color: color,
      type: dotTypeMap[qrDotStyle] || 'square'
    },
    backgroundOptions: {
      color: '#ffffff'
    },
    cornersDotOptions: {
      color: color
    },
    cornersSquareOptions: {
      color: color
    },
    qrOptions: {
      errorCorrectionLevel: 'M'
    }
  };

  if (qrCodeInstance) {
    preview.innerHTML = '';
  }

  qrCodeInstance = new QRCodeStyling(opts);

  const container = document.createElement('div');
  preview.innerHTML = '';
  preview.appendChild(container);
  qrCodeInstance.append(container);

  setTimeout(() => {
    const canvas = container.querySelector('canvas');
    if (canvas) {
      qrDataUrl = canvas.toDataURL('image/png');
      const img = document.createElement('img');
      img.src = qrDataUrl;
      img.style.cssText = 'max-width:80px;max-height:80px;border:1px solid #ccc';
      preview.innerHTML = '';
      preview.appendChild(img);
      renderBadges();
    }
  }, 200);
}

function updateLogoWidth() {
  logoWidthPct = document.getElementById('logoWidth').value;
  document.getElementById('logoWidthVal').textContent = logoWidthPct + '%';
  renderBadges();
}

function setLogoAlign(align, el) {
  logoAlign = align;
  el.closest('.layout-row').querySelectorAll('.layout-btn').forEach(b => b.classList.remove('active'));
  el.classList.add('active');
  renderBadges();
}

function setLayout(layout, el) {
  currentLayout = layout;
  document.querySelectorAll('.layout-btn').forEach(b => b.classList.remove('active'));
  el.classList.add('active');
  document.getElementById('layoutDesc').innerHTML = layoutDescriptions[layout];
  renderBadges();
}

function changeFont() {
  currentFont = document.getElementById('fontSelect').value;
  const link = document.getElementById('badgeFontLink');
  const fontName = currentFont.replace(/ /g, '+');
  link.href = `https://fonts.googleapis.com/css2?family=${fontName}:wght@300;400;700;900&display=swap`;
  setTimeout(renderBadges, 100);
}

function loadExcel(event) {
  const file = event.target.files[0];
  if (!file) return;

  const area = document.getElementById('excelArea');

  const reader = new FileReader();
  reader.onload = function(e) {
    const data = new Uint8Array(e.target.result);
    let opts = { type: 'array' };
    if (file.name.toLowerCase().endsWith('.csv')) {
      const text = new TextDecoder('utf-8').decode(data);
      const firstLine = text.split('\n')[0] || '';
      opts.FS = firstLine.includes(';') ? ';' : ',';
    }
    const workbook = XLSX.read(data, opts);
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });

    let start = 0;
    if (rows.length > 0) {
      const first = rows[0].map(c => (c || '').toString().toLowerCase().trim());
      if (first.includes('navn') || first.includes('name') ||
          first.includes('stilling') || first.includes('title') ||
          first.includes('firma') || first.includes('company')) {
        start = 1;
      }
    }

    entries = [];
    for (let i = start; i < rows.length; i++) {
      const row = rows[i];
      if (!row || row.length < 1) continue;
      const name = (row[0] || '').toString().trim();
      if (!name) continue;
      const title = row.length >= 2 ? (row[1] || '').toString().trim() : '';
      const company = row.length >= 3 ? (row[2] || '').toString().trim() : '';
      entries.push({ name, title, company });
    }

    area.classList.add('has-file');
    area.innerHTML =
      `<span class="upload-filename">${esc(file.name)}</span>
       <span class="upload-hint">${entries.length} importert</span>
       <input type="file" accept=".xlsx,.xls,.csv" onchange="loadExcel(event)">`;

    renderEntries();
    renderBadges();
  };
  reader.readAsArrayBuffer(file);
}

function parseTextInput() {
  const raw = document.getElementById('inputList').value.trim();
  if (!raw) return;

  const lines = raw.split('\n').map(l => l.trim().replace(/,+$/, '')).filter(l => l.length > 0);

  entries = [];
  for (let i = 0; i < lines.length; i += 3) {
    const name = lines[i];
    const title = lines[i + 1] || '';
    const company = lines[i + 2] || '';
    if (name) {
      entries.push({ name, title, company });
    }
  }

  renderEntries();
  renderBadges();
}

function renderEntries() {
  const list = document.getElementById('entriesList');
  document.getElementById('entriesHeader').textContent = `Liste (${entries.length})`;

  list.innerHTML = entries.map((e, i) => `
    <div class="entry-item">
      <div>
        <div class="entry-name">${esc(e.name)}</div>
        ${e.title ? `<div class="entry-commission">${esc(e.title)}</div>` : ''}
        ${e.company ? `<div class="entry-country">${esc(e.company)}</div>` : ''}
      </div>
      <button class="remove-btn" onclick="removeEntry(${i})">x</button>
    </div>
  `).join('');
}

function esc(str) {
  const d = document.createElement('div');
  d.textContent = str;
  return d.innerHTML;
}

function removeEntry(index) {
  entries.splice(index, 1);
  renderEntries();
  renderBadges();
}

function clearAll() {
  entries = [];
  renderEntries();
  renderBadges();
}

function renderBadges() {
  const area = document.getElementById('previewArea');
  const w = document.getElementById('badgeWidth').value || 92;
  const h = document.getElementById('badgeHeight').value || 59;
  const fontName = document.getElementById('fontSize_name').value || 18;
  const fontComm = document.getElementById('fontSize_commission').value || 12;
  const fontCompany = document.getElementById('fontSize_company').value || 9;

  const hasContent = entries.length > 0 || logoDataUrl || qrDataUrl;
  if (!hasContent) {
    area.innerHTML = '<div class="empty-state"><p>Versjon 1.0 — av Hallvar Bugge Johnsen / hei@hallvar.no</p></div>';
    return;
  }

  document.querySelectorAll('.design-section').forEach(s => s.style.display = '');

  const badgesPerPage = 8;
  const qrImg = qrDataUrl ? `<img src="${qrDataUrl}" alt="QR">` : '';
  const layoutClass = `badge--layout-${currentLayout}`;
  const alignMap = { left: 'flex-start', center: 'center', right: 'flex-end' };
  const logoHtml = logoDataUrl
    ? `<div style="display:flex;justify-content:${alignMap[logoAlign]}"><img class="logo-img" src="${logoDataUrl}" alt="Logo" style="width:${logoWidthPct}%;height:auto"></div>`
    : '';

  const displayEntries = entries.length > 0
    ? entries
    : [{ name: 'Fornavn Etternavn', title: 'Stilling', company: 'Firma AS' }];

  let html = entries.length > 0
    ? `<div class="badge-count">${entries.length} navneskilt / ${Math.ceil(entries.length / badgesPerPage)} sider</div>`
    : '';

  for (let i = 0; i < displayEntries.length; i++) {
    if (i % badgesPerPage === 0) {
      if (i > 0) html += '</div>';
      html += '<div class="page">';
    }
    const e = displayEntries[i];
    html += `
      <div class="badge ${layoutClass}" style="width:${w}mm;height:${h}mm;">
        <div class="badge-top">
          ${logoHtml}
        </div>
        <div class="badge-bottom">
          <div class="qr">${qrImg}</div>
          <div class="info">
            <div class="name" style="font-family:'${currentFont}',sans-serif;font-size:${fontName}pt">${esc(e.name)}</div>
            ${e.title ? `<div class="commission" style="font-family:'${currentFont}',sans-serif;font-size:${fontComm}pt">${esc(e.title)}</div>` : ''}
            ${e.company ? `<div class="country" style="font-family:'${currentFont}',sans-serif;font-size:${fontCompany}pt">${esc(e.company)}</div>` : ''}
          </div>
        </div>
      </div>
    `;
  }
  html += '</div>';

  area.innerHTML = html;
}

let resetPending = false;

function resetAll() {
  const btn = document.getElementById('resetBtn');
  if (!resetPending) {
    resetPending = true;
    btn.textContent = 'Sikker?';
    btn.style.background = '#c0392b';
    btn.style.color = '#fff';
    btn.style.borderColor = '#c0392b';
    return;
  }
  resetPending = false;
  btn.textContent = 'Nullstill';
  btn.style.background = '';
  btn.style.color = '';
  btn.style.borderColor = '';

  entries = [];
  logoDataUrl = null;
  qrDataUrl = null;
  qrCodeInstance = null;
  logoWidthPct = 100;
  logoAlign = 'center';
  currentLayout = 'a';
  currentFont = 'Lato';
  qrDotStyle = 'square';

  document.getElementById('badgeWidth').value = 92;
  document.getElementById('badgeHeight').value = 59;
  document.getElementById('qrUrl').value = '';
  document.getElementById('qrColor').value = '#000000';
  document.getElementById('qrPreview').innerHTML = '';
  document.getElementById('inputList').value = '';
  document.getElementById('fontSize_name').value = 18;
  document.getElementById('fontSize_commission').value = 12;
  document.getElementById('fontSize_company').value = 9;
  document.getElementById('fontSelect').value = 'Lato';
  document.getElementById('logoWidth').value = 100;
  document.getElementById('logoWidthVal').textContent = '100%';

  const logoArea = document.getElementById('logoArea');
  logoArea.classList.remove('has-file');
  logoArea.innerHTML = '<span class="upload-text">Last opp logo</span><span class="upload-hint">.png / .jpg</span><input type="file" accept="image/*" onchange="loadLogo(event)">';
  document.getElementById('logoControls').style.display = 'none';

  const excelArea = document.getElementById('excelArea');
  excelArea.classList.remove('has-file');
  excelArea.innerHTML = '<span class="upload-text">Last opp regneark</span><span class="upload-hint">.xlsx / .csv</span><input type="file" accept=".xlsx,.xls,.csv" onchange="loadExcel(event)">';

  document.querySelectorAll('.design-section').forEach(s => s.style.display = 'none');
  document.querySelectorAll('.qr-style-btn').forEach(b => b.classList.remove('active'));
  document.querySelector('.qr-style-btn[data-style="square"]').classList.add('active');

  renderEntries();
  renderBadges();
}

document.addEventListener('click', function(e) {
  if (resetPending && e.target.id !== 'resetBtn') {
    resetPending = false;
    const btn = document.getElementById('resetBtn');
    btn.textContent = 'Nullstill';
    btn.style.background = '';
    btn.style.color = '';
    btn.style.borderColor = '';
  }
});

function printBadges() {
  if (entries.length === 0) {
    alert('Ingen deltakere. Importer data forst.');
    return;
  }
  window.print();
}
</script>

</body>
</html>
